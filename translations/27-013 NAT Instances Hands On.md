---
source: 27 - Networking - VPC\013 NAT Instances Hands On_zh.srt
---

- ：那么, 让我们创建一个NAT实例,

以便为我们的专用子网提供Internet访问｡

我单击Launch instance（启动实例）,

然后键入NAT instance（NAT实例）, 现在我们需要找到NAT实例的Amazon映像｡

为此, 我将在此处浏览更多AMI, 然后需要输入搜索词,

如NAT､ N-A-T,

然后按Enter键｡

正如我们所看到的,

社区AMI中有40个结果｡

我单击社区AMI,

现在可以看到一些来自AWS的NAT实例｡

所以你可以找到一个, 只要它写着, X8664.

您可以查看发布日期以尝试找到更新类型的实例｡

所以我可以找到这个发布日期为2022年, 只要上面写着Amazon

AMI VPC NAT 2018, 类似这样的东西,

那么你就可以开始了｡

64.第64章最后一次

好吧, 那我们就选这个｡ 

看起来很新｡ 

但是您知道, 无论您选择什么, NAT实例都是足够好的｡

我们看看接下来会发生什么｡ 

所以别太担心, 我们开始吧｡ 

我正在使用AWS的社区AMI来部署NAT实例｡

我用的是T2微型摄像机｡ 

对于密钥对, 我将只使用演示密钥对｡ 

然后, 对于网络设置, 我们将添加､ 编辑此设置,

并创建一个新的安全组｡

因此, 规则明智, 我们要创造一些东西｡ 

所以无论在哪里, 都是SSH｡ 

那我们就得增加更多的规则｡ 

HTTP, 然后源是CIDR,

CIDR块与我们的VPC相同｡

所以10 0 0 0斜线16｡ 

然后, 我们将执行相同的操作, 但对于HTTPS,

允许HTTPS流量也从同一CIDR块传出｡

最后要做的是, 当然, 编辑VPC设置,

使其包含在我的演示VPC中｡

我们在公共子网（例如, 公共子网A）中部署此NAT实例｡

所以我们得重做｡ 

因此NAT实例中, SG是安全组的名称｡ 

实际上我的角色还保留着｡ 

因此, 请确保将其命名为NAT实例SG｡ 

好了, 我们可以开始了.

现在, 让我们启动该实例｡ 

我们就完事了｡ 

我们要做的是让私有实例通过NAT实例发送Internet流量｡

好的, 现在我的NAT实例已经创建,

我需要做的是编辑一个名为源目标检查的网络设置｡

所以我得阻止这一切｡ 

这是因为, 如果这是NAT实例,

则必须停止源目标检查, 因为当源或目标不是它自己时,

NAT实例必须能够接收和发送流量｡

所以这一点非常重要｡ 

我们单击“Save”（保存）, 不知何故, 我们知道我们将对NAT实例使用此选项｡

所以这真的很好｡ 

接下来, 我们要做的是向NAT实例发送一些流量｡

首先, 我们来验证一下｡ 

因此, 我将通过SSH重新连接到我的私有实例,

为此, 我必须通过堡垒主机｡

因此我将使用EC 2实例连接｡ 

好极了｡  我已连接到堡垒主机,

然后将使用SSH命令｡

因此, EC2 user @, 然后我需要在此处输入我的私有实例的私有IP｡

我复制这个并粘贴它减去演示密钥对｡

质子交换膜

好吧, 我在我的私人空间里｡ 

再一次, 请记住, 如果我们PING谷歌｡  我们没有收到任何回复｡

所以这里不能上网｡ 

现在, 让我们为专用子网提供Internet访问权限｡ 

要在我的专用路由表中执行此操作, 我们需要在路由上编辑路由｡

所以我们来编辑它们｡ 

目前, 我们有一个本地规则,

但我们将有一个说, 如果你想在互联网上说话,

那么请通过你的实例｡

并且实例必须是NAT实例, 保存｡ 

我们有效地做到了这一点：“对于此子网中的任何EC

2实例, 因为它与此路由表关联｡ 如果您将流量发送到Internet, 那么无论在何处, 都要通过我的EC

2实例, 这正是NAT实例的用途｡

所以现在如果我们再尝试PING谷歌｡

这是行不通的

我知道原因, 因为我们还需要在NAT实例上启用一个特定端口｡

现在, 让我们转到安全性和安全组规则,

我们需要为PING启用特定端口｡

因此, 让我们编辑入站规则,

我将为PING添加一个规则｡

所以是ICMP｡ 

因此, 所有ICMP､ IPV4都来自CIDR中的该子网｡

好的, 然后点击保存｡ 

现在, 如果我们再试一次, PING命令｡ 

所以, 让我们清空屏幕, 然后再次PING｡ 

现在我们正在得到一些结果｡ 

这是可行的, 如果我们想选择, 例如curl谷歌｡

com, 正如我们所看到, 我们得到了一些结果｡ 

这是来自Google的HTML页面｡

com或更高｡ 

如果我做了curl的例子｡  这将是一个更容易查看的页面｡

好吧, 一切正常｡ 

PING正常工作, curl正常工作,

HTTP访问, HTTPS访问｡

我们有ICMP｡ 

所以这是PING等等｡ 

因此, 我们所做的有效工作是,

我们为我的专用子网中的实例提供了Internet访问权限,

而没有将它们暴露给Internet｡

正如我们所看到的, 我的私有子网实例仍然没有公共IP｡

我们要用太空堡垒好吗

这节课就讲到这里, 非常非常好.

但在下一节课中, 我们将使用NAT的网关,

它会更好｡

我现在要做的是回到我的实例中｡ 

我们不再需要NAT实例,

我将停止它｡

好吧, 或者你也可以终止｡ 

反正我们也不会用它｡ 

所以对于这节课, 我希望你们喜欢｡ 

我们下节课再见｡

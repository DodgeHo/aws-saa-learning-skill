---
source: 10 - Route 53\013 Routing Policy - Failover_zh.srt
---

导师：好的, 现在我们来谈谈路由策略,

这一条是针对故障转移的｡

我们的想法是, 我们在中间有路由53,

我们有EC2实例, 其中一个将是我们的主EC2实例,

第二个将是辅助EC2实例,

即灾难恢复EC2实例｡

在本例中, 我们要将主记录与运行状况检查关联起来,

这是强制性的｡

如果运行状况检查结果不正常,

则路由53将自动故障切换到第二个EC2实例,

并开始将结果发回｡

当然, 如果我们需要, 辅助EC2也可以与运行状况检查关联｡

但只能有一个主要和一个次要｡ 

现在, 当客户端发出DNS请求时,

它将自动获取被认为运行正常的资源｡

所以如果我们的主要是健康的, 那么53号公路将回答一个主要的记录｡

但是, 如果运行状况检查不正常,

我们将自动获得第二条记录的响应,

这确实有助于我们执行（模糊的）故障转移｡

好了, 让我们开始动手练习,

看看我们如何练习｡

好的, 现在让我们利用这些运行状况检查并创建故障切换记录｡

因此, 在我的托管区域中, 我将创建一个记录, 这个记录将称为故障转移｡

斯蒂芬老师｡  com,

它是A记录,

第一个值是我的EU-central-1实例,

也就是离我最近的那个, 路由策略是故障转移｡

TTL会将其设置为非常低的值,

例如60秒｡

故障转移记录类型有两个选项｡ 

它可能是主要的或次要的, 只有这两个｡ 

所以这是我的主要记录, 我会将它与健康检查联系起来,

我必须这样做｡

因此, 它将与名为EU-central-1的运行状况检查关联,

并且记录ID将为E｡

也就是说, 此记录应该是我的主记录,

但它将与运行状况检查相关联,

这意味着您可以故障切换到第二个记录｡

我们来添加一条新记录, 并将记录名称保留为failover｡

斯蒂芬老师｡  它的值将是我在US-east-1中的实例｡

好的, 我们仍然需要执行故障切换,

TTL为60秒, 故障切换记录类型将为次要｡

现在, 我们可以选择将您的健康检查与它关联, 好的,

美国东部1号, 但您不必这样做｡

记录ID将是US｡ 

现在, 让我们创建此记录,

请注意, 它已成功创建｡

让我们回到健康检查｡ 

目前, 这两项与我的记录相关联的健康检查是健康的｡

如果我进入URL, 那么如果我进入故障切换｡

斯蒂芬老师｡  现在,

我从EU-central-1c得到了一个答案, 那太好了｡

但我要做的是触发一个失败｡ 

让我们进入EU-central-1区域,

我将在这里找到我的实例, 并找到安全组, 然后再次停止一些安全组角色｡

让我们刷新此页面｡ 

它确实存在, 那太完美了｡ 

对于入站规则, 我将对其进行编辑,

它将删除端口A上的规则｡

因此, 这将使我的实例完全无法从健康检查器访问｡

我现在要做的就是等待运行状况检查变为不正常状态,

然后我们就可以测试故障切换了｡

我们来刷新一下, 现在我们可以看到, 我的EU-central-1运行状况检查被认为是不正常的,

我们可以查看“监视”选项卡, 看看它何时出现不正常的情况,

这非常酷｡

健康检查器是阳性的,

然后它变成了零, 然后我们可以看到有多少百分比的健康检查器报告健康,

再次, 这下降到零｡

这意味着,

由于我们设置与此运行状况检查关联的故障切换的方式,

此运行状况检查现在处于不正常状态｡

那么下次刷新时, 我不应该在欧盟中部-1c,

我应该在美国东部-1｡

所以, 让我们刷新这个（模糊的）页面,

是的, 答案是我们在美国东部1｡

因此, 故障转移确实在后台无缝运行｡ 

在修复时, 您只需返回安全组,

编辑入站规则, 然后重新添加HTTP规则, 然后运行状况检查将自动再次通过, 因此我们将故障切换回主位置｡

这节课就讲到这里, 希望你们喜欢,

下节课再见｡

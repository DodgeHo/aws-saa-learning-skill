---
source: 12 - Amazon S3 Introduction\011 S3 Replication - Hands On_zh.srt
---

教师：让我们在Amazon

S3上练习复制｡

为此, 我们将创建一个新的存储桶｡ 

我称之为s3-斯蒂芬-水桶-起源-v2｡ 

我将它设置在一个我想要的区域,

例如eu-west-1｡

这将是我的原始存储桶,

然后数据将从这个存储桶复制到另一个存储桶｡

因此, 我需要做的事情当然是启用版本控制,

因为只有启用了版本控制,

复制才能工作｡

所以我会创造这个桶｡ 

然后在新选项卡中打开此桶｡ 

我将创建第二个桶,

这将是我的目标桶｡

所以我会做s3-斯蒂芬-桶-复制-v2｡ 

这一次, 区域可以是相同的,

例如, 如果您要执行相同的区域复制, 也可以是完全不同的区域,

例如, 如果您要执行美国复制,

则可以执行us-east-1, 从欧洲复制到美国｡

好的, 现在我们向下滚动,

再次在目标存储桶上启用存储桶版本控制｡

我们准备好了｡ 

现在我们有了主存储桶和辅助存储桶｡

我将在源存储桶中上传一个文件,

例如, 我将添加一个关于我的海滩的文件｡

海滩｡  jpg格式｡ 

好了, 搞定了, 我们可以结案了.

现在有了一个文件,

当然, 还没有复制, 因为我们还没有设置复制｡

所以让我们开始吧｡ 

在源存储桶上, 我需要做的是进入“Management”（管理）下,

向下滚动, 看到复制规则｡

目前为零｡ 

因此, 让我们继续创建第一个复制规则｡ 

所以我把它叫做DemoReplicationRule｡ 

好的, 很好｡ 

我们将其设置为已启用｡ 

对于源存储桶, 我们将保持不变,

而就规则范围而言, 我们将把它应用于存储桶中的所有对象｡

现在, 对于目标,

我们可以在此帐户或另一帐户中指定一个存储桶｡

我们将在此帐户中选择一个｡ 

而存储桶名称就是我的目标存储桶｡ 

所以我需要输入名字｡ 

所以我们把这个桶放在这里,

复制粘贴｡

好的, 如您所见,

目标区域被标识为“美国东部1”｡

因此, 这是一个跨区域复制｡ 

好吧, 我会的

现在, 对于IAM角色,

我们实际上需要为此创建一个新角色｡

所以我有个选择｡ 

然后我们可以查看一些设置, 但现在这对我们来说并不重要｡

我们还是省省吧｡ 

所以我们在这里得到一个提示,

它说你想复制现有的对象吗？

因此, 当您启用复制时, 它将只复制您设置它时的对象｡

所以对于更新的上传｡ 

因此, 如果您想将之前的对象从源存储桶复制到目标存储桶,

您可以使用一种称为“批处理操作”的S3批处理操作来执行此操作,

并且您需要说“是”, 复制现有对象｡

但这与复制功能本身是分开的｡

因此, 我要说不,

不要复制现有对象｡

我们准备好了｡ 

现在让我们来看看｡ 

因此, 我们有一个复制规则已准备就绪的管理｡

现在我要做的是检查我的复制桶｡

当然, 如果我现在刷新,

我们会看到对象尚未复制｡

那么我现在要做的就是上传一个新的文件,

比如说, 上传咖啡｡ . jpg文件｡ 

上传｡ 

我们结束了｡ 

这是咖啡｡  . jpg文件｡ 

让我们来看看版本｡ 

这就是咖啡｡  jpg, 版本为GBk｡ 

好的, 很好｡ 

现在, 如果我们进入我的目标桶, 并刷新它,

它可能需要五秒钟｡

第一次复制大约花了10秒钟, 但我们可以看到我的咖啡｡

jpg已添加到我的副本桶中｡

如果我显示版本, 我们可以看到我的咖啡的版本ID｡

jpg与原始桶完全相同｡

所以版本的ID被复制了,

这很好｡

如果我想进口海滩｡  jpg, 我需要上传一个新版本的文件｡

那我们上传海滩吧｡  jpg格式｡ 

现在这个已经上传了,

我们可以看看版本,

所以这里有一个新版本的DK2我的海滩｡

. jpg文件｡ 

现在, 如果我在这里刷新一下, 现在让我们再看一个对考试很重要的设置｡

如果我返回到“管理”, 并使用此对话框编辑此角色,

我们可以向下滚动并查看一个名为“删除标记复制”的设置｡

因此, 默认情况下, 删除标记不会被复制,

但有一个功能可以做到这一点｡

因此, 如果您启用删除标记复制,

则它们将从一个存储桶复制到另一个存储桶｡

所以让我们保存这个｡ 

因此, 我的复制规则已保存｡ 

这就意味着如果我进入这个桶, 我选择删除这个文件,

比如说, 我删除了我的咖啡｡

jpg文件, 让我们删除它｡ 

这实际上会创建一个删除标记,

因为我的桶是版本化的｡

我们结束了｡ 

所以现在我的咖啡｡  jpg的文件被删除｡ 

让我们看看这里｡ 

我们先刷新一下, 然后再等一会儿｡ 

现在, 您可以看到删除标记已复制到我的副本存储桶中｡

所以如果我不显示版本, 我就看不到我的咖啡｡

jpg文件,

但当然, 如果我显示版本, 我会看到它｡

在这里是真的｡ 

当然, 这里也是如此｡ 

所以删除标记被删除了,

但是如果你决定删除一个文件的特定版本,

比如, 我删除了这个,

也就是我删除了一个特定的版本ID.

这就是所谓的永久删除｡ 

如果我永久删除了我的原始桶中的一个对象,

它将不会被复制到我的副本桶中｡

所以这个海滩｡  这里的jpg永远不会被删除,

因为只有删除标记被复制, 而不是删除,

好吗？

这节课就讲到这里｡ 

我希望你们喜欢它, 我们下节课再见｡

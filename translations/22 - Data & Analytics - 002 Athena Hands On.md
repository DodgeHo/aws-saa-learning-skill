---
source: 22 - Data & Analytics\002 Athena Hands On_zh.srt
---

鏁欏笀锛氬ソ鐨? 璁╂垜浠娇鐢ˋthena鏈嶅姟,

浣跨敤SQL鏌ヨ璇█鏌ヨAmazon S3涓殑鏁版嵁锝?

鎵€浠ユ垜浠繘鍏ヤ簡Athena, 姝ｅ鎴戜滑鎵€鐪嬪埌鐨?

杩欐槸鏂扮殑缂栬緫鍣健

鍥犳, 鍦ㄨ繍琛岀涓€涓煡璇箣鍓?

闇€瑕佸湪AmazonS3涓缃竴涓煡璇㈢粨鏋滀綅缃健

鎴戜滑鍗曞嚮鈥淰iew settings锛堟煡鐪嬭缃級鈥? 鐒跺悗鍗曞嚮鈥淢anage锛堢鐞嗭級鈥濓健 

鐒跺悗, 鍦ㄨ繖閲? 褰撹鎸囧畾鏌ヨ缁撴灉鐨勪綅缃椂锝?

鎴戦渶瑕佸仛鐨勫氨鏄繘鍏mazon S3,

鍒涘缓涓€涓猙ucket, 鎴戝皢瀹冨懡鍚嶄负stephane-demo-athena-eu-central-1, 瀹冨簲璇ユ槸鍞竴鐨勶健

鐒跺悗鎴戜滑浼氬垱寤鸿繖涓《锝?

鐜板湪宸插垱寤轰簡瀛樺偍妗? 鎴戝彲浠ュ崟鍑烩€淰iew details鈥濓紙鏌ョ湅璇︾粏淇℃伅锛夛健 

杩欐槸鎴戠殑妗? 鎴戝彲浠ュ湪杩欓噷澶嶅埗妗剁殑鍚嶇О锝?

鎴戝彧闇€瑕佽緭鍏3锛?/, 鐒跺悗杈撳叆鎴戠殑瀛樺偍妗跺悕绉帮健 

鍙渶鍗曞嚮鈥滀繚瀛樷€? 鐜板湪鎴戠殑鏌ヨ缁撴灉浣嶇疆灏嗕綅浜庢S3瀛樺偍妗朵腑锝?

鐜板湪, 鎴戜滑宸茬粡瀹屾垚浜嗚繖涓€姝?

鍙互鍒锋柊姝ら〉闈? 鎴戜滑鍙互鐪嬪埌宸茬粡鏈変竴浜涙暟鎹簮锝?

AwsDataCatalog鍜屼竴浜涙暟鎹簱鍙互浣跨敤浜嗭健

浣嗘垜瑕佸仛鐨勬槸鍒涘缓鎴戣嚜宸辩殑鏁版嵁搴?

璁╁畠宸ヤ綔, 鍥犱负浣犲彲鑳戒笉涓€瀹氭湁杩欎釜锝?

鎵€浠? 瀵逛簬杩欎釜, 瀹冩槸鐩稿綋瀹规槗鐨勶健 

鎴戜滑灏嗗湪Amazon S3涓垱寤篠3璁块棶鏃ュ織锝?

鍥犳, 鎴戝垱寤轰簡鍚嶄负demo-s3-access-logs-stephane-2020鐨勫瓨鍌ㄦ《,

瀹冨湪S3鏃ュ織鏂囦欢澶逛腑鍖呭惈鎴戠殑璁块棶鏃ュ織锝?

鎴戠幇鍦ㄨ鍋氱殑灏辨槸鍒涘缓涓€涓暟鎹簱,

鍒涘缓涓€涓〃鏉ユ樉绀鸿繖閲岀殑瀵硅薄锝?

閭ｄ箞, 鎬庝箞杩欐牱鍋氬憿锛?

濂藉惂, 璁╂垜浠繘鍏ユ垜浠殑浠ｇ爜锝?

鍦⊿3浜嬩欢涓嬬殑绗竴琛? athena-s3-access-logs-sql,

鐢ㄤ簬鍒涘缓姝ゆ暟鎹簱锝?

鍥犳, 鎴戜滑灏嗙矘璐存鍐呭,

鍒涘缓鏁版嵁搴? 鐒跺悗鍗曞嚮鈥淩un鈥濓健

杩欐牱灏辨垚鍔熷垱寤轰簡涓€涓暟鎹簱, 鐜板湪鎴戜滑鏈変簡涓€涓壒瀹氱殑鏁版嵁搴?

杩欓噷绉颁负s3_access_logs_db锝?

鎺ヤ笅鏉? 鎴戜滑闇€瑕佸垱寤轰竴涓〃绀哄瓨鍌ㄦ《鏃ュ織鐨勫閮ㄨ〃锝?

璁╂垜绮樿创, 澶嶅埗, 绮樿创杩欎釜锝?

闂鏄? 鎴戞槸鎬庝箞寰楀埌杩欎釜鐨勶紵

濡傛灉浣犺緭鍏thena s3璁块棶鏃ュ織, 鍦ㄤ簰鑱旂綉涓?

浣犱細鏈変竴涓摼鎺? 杩欎釜閾炬帴瀹為檯涓婁細缁欎綘鏌ヨ鍗曚綅,

浣犲仛鐨? 浠ュ垱寤鸿繖浜涢€傚綋鐨勮闂棩蹇楋健

鍥犳, 鎴戝繀椤绘洿鏀圭殑涓€浠朵簨鏄湪location涓?

浣曟椂鏇存敼鐩爣瀛樺偍妗剁殑鍚嶇О鍜屽墠缂€锝?

鎴戠殑灞炴€т細缁欐垜杩欎釜, 鎵€浠ユ垜澶嶅埗杩欎釜S3

URI, 瀹冩湁bucket鍚嶇О鍜屽墠缂€.

鎴戞妸杩欎釜璐村湪杩欓噷, 灏卞彲浠ュ紑濮嬩簡锝?

鐜板湪璁╂垜浠繍琛岃繖涓懡浠? 鐜板湪鏌ヨ鎴愬姛浜嗭健 

鐜板湪, 鍦ㄨ繖涓暟鎹簱涓? 鎴戜滑鐪嬪埌鏈変竴涓悕涓簃ybuckets_logs鐨勮〃,

鍏朵腑鍖呭惈璁稿鍒楋健

濡傛灉鎴戝崟鍑昏閫夐」, 鐒跺悗鍗曞嚮鈥淧review Table鈥濓紙棰勮琛級,

鐜板湪灏嗕粠鎴戠殑琛ㄤ腑閫夋嫨涓€棰楁槦,

闄愬埗涓?0棰楋健

鍦ㄥ簳閮? 鎴戜滑鍙互鐪嬪埌瀹冭繑鍥炰簡10琛? 杩?0琛屼唬琛ㄤ簡鎴戠殑璁块棶鏃ュ織,

鎵€浠ヨ繖闈炲父鏂逛究锝?

鐜板湪鎴戝彲浠ュ湪杩欎釜琛ㄤ腑鑾峰緱鎵€鏈夌殑璁块棶鏃ュ織鏁版嵁,

闈炲父闈炲父鏂逛究锝?

鎵€浠ヨ繖鍙槸琛ㄩ潰鐜拌薄, 鍥犱负鐜板湪,

浣跨敤Athena, 鎴戜滑鍙互杩愯涓€浜涙洿鏈夎叮鐨勬煡璇㈢被鍨嬶健

鎵€浠? 姝ｅ鎴戜滑鐜板湪鎵€鐪嬪埌鐨? 鎴戜滑浠€涔堜篃娌″仛锝?

鎴戜滑娌℃湁璁剧疆浠讳綍鏁版嵁搴? 涔熸病鏈夐厤缃暟鎹簱,

杩欓兘鏄棤鏈嶅姟鍣ㄧ殑锝?

鎵€鏈夎繖浜涙煡璇㈤兘鏄敱Athena鏈嶅姟鐩存帴瀵筍3妗朵腑鐨勬暟鎹繍琛岀殑,

鎴戣涓鸿繖鏄潪甯稿己澶х殑锝?

鎵€浠? 鍦ㄨ繖涓煡璇腑, 鎴戜滑瑕佷粠杩欎釜琛ㄤ腑鑾峰彇requesturi_operation,

httpstatus, count star, 鏉ヨ绠楁湁澶氬皯,

鎴戜滑瑕佹墽琛孏ROUP BY锝?

杩欐槸涓€涓洿楂樼骇鐨凷QL鏌ヨ,

浣嗗畠灏嗕负鎴戜滑鎻愪緵涓€涓姸鎬佷唬鐮佹姤鍛婃棩蹇?

浠ュ強瀹冧滑鍙戠敓鐨勬鏁帮健

鍥犳, 鎴戜滑鍙互鐪嬪埌, 渚嬪, GET 404鍙戠敓浜?9娆?

HEAD 200鍙戠敓浜?1娆? 浠ユ绫绘帹, 鎴栬€匞ET 403鍙戠敓浜?4娆★健

渚嬪, 杩欏彲浠ュ府鍔╂垜浠敓鎴愪竴涓姤鍛?

浠ヤ究棰勬祴鍝簺绫诲瀷鐨勬煡璇㈡垨鍝簺绫诲瀷鐨勮姹傚湪鎴戜滑鐨刡ucket涓婃病鏈夊彂鐢熸垨娌℃湁鎴愬姛,

闈炲父鏂逛究锝?

鏈€鍚庝竴涓緥瀛? 鎴戜滑鐪嬪埌鏈夊嚑涓?

鍥涗釜鎴栦笁涓敊璇? 鎵€浠ュ畠鍙互璇? 鍢? 杩欐槸褰撳畠鏄湭缁忔巿鏉冪殑,

杩欐槸闈炲父鍙枒鐨? 瑕佷箞鏈変汉娌℃湁琚巿鏉冨仛鏌愪簨, 閰? 鎴戜滑鎯崇煡閬撹皝鍜屼负浠€涔堬健

鎴栬€? 濡傛灉鏈変汉璇曞浘鏈粡鎺堟潈璁块棶鎴戜滑鐨勬《,

鑰屾垜浠兂娣卞叆浜嗚В瀹冿健

鍚屾牱, 鎴戜滑杩愯姝ゆ煡璇? 鐒跺悗鎴戜滑鏈?4琛?

杩欓噷娌℃湁杩欎簺琛? 鍥犱负鏁版嵁鍙兘闈炲父澶?

浣嗘垜浠湁44琛? 濂藉惂, 杩欎簺琛屽皢琛ㄧず鐢熸垚鐨勬煡璇㈢被鍨? 骞舵渶缁堢敓鎴?03,

杩欓潪甯告柟渚匡健

鍥犳, 鍐嶆寮鸿皟, Athena鐨勫叏閮ㄥ姛鑳芥槸,

鎴戜滑鑳藉鍦ˋmazon S3涓婃煡璇㈡暟鎹?

鐩存帴鎵ц涓€浜涘鏉傜殑鏌ヨ,

鑰屾棤闇€璁剧疆浠讳綍鏈嶅姟鍣? 鏃犻渶杞崲鏁版嵁, 鍙渶璁剧疆姝ｇ‘鐨勬暟鎹牸寮? 骞舵寚瀹氭暟鎹唴瀹?

Athena灏辫兘澶熷府鍔╂垜浠畬鎴愭墍鏈夎繖浜涗簨鎯咃健

鏈€鍚? 鍦ˋthena涓? 鎮ㄥ彲浠ユ煡鐪嬫渶杩戠殑鏌ヨ浠ュ強淇濆瓨鐨勬煡璇紙濡傛灉鎮ㄦ効鎰忥級,

濡傛灉鎮ㄥ笇鏈涘湪鐩爣妗朵腑鍔犲瘑鏌ヨ缁撴灉,

鍒欏彲浠ョ紪杈戣缃健

杩欒妭璇惧氨璁插埌杩欓噷, 甯屾湜浣犱滑鍠滄,

涓嬭妭璇惧啀瑙侊健


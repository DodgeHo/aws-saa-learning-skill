---
source: 04 - IAM & AWS CLI\004 IAM Policies Hands On_zh.srt
---

教师：现在让我们深入了解IAM策略｡

首先, 让我们进入用户｡ 

正如您所看到的, 用户Stephane是管理员组的一部分,

因此具有AWS的管理员访问权限｡

这意味着, 如果我使用我的用户Stephane进入IAM控制台,

那么现在我使用我的用户, 然后我转到左手边并单击用户, 如您所见, 我可以看到我的用户Stephane,

就在这里｡

所以我的用户Stephane有权限做任何事情,

因为他是管理员｡

但是我要做的是, 我要去管理员组,

然后我要从该组中删除我的用户Stephane｡

因此, 通过删除用户, 我现在已经这样做了,

然后Stephane失去了它在右侧的权限｡

我们如何确保这一点？

好吧, 让我们刷新这个页面｡ 

正如你所看到的, 现在我看到零个用户,

我的访问被拒绝, 它说我没有权限执行iamListUsers｡

因此, 因为我从管理组中删除了Stephane用户,

所以我失去了查看右侧用户的权限｡

所以让我们试着解决这个问题｡ 

我们进入IAM,

在用户下面, 找到斯蒂芬｡

现在, 正如您所看到的,

Stephane没有权限策略, 但让我们添加权限｡

因此, 我们可以直接添加权限或创建内联策略｡

所以让我们添加权限, 这会更容易｡ 

同样, 我们可以将用户添加回组｡ 

这不是我们想要的

或者我们可以直接将策略附加到我的用户｡ 

所以我要附加的策略是IAM只读访问｡

所以这将允许我的用户Stephane阅读IAM上的任何内容,

这就是我们想要的｡

所以让我们添加此权限,

现在此策略已添加｡

回到这里, 让我们刷新这个页面｡ 

正如您现在所看到的, 我终于可以再次执行API调用,

并查看我的用户类别中的Stephane用户｡

所以我可以查看用户, 我可以查看用户组, 如管理员, 但我可以创建一个组吗？

让我们尝试创建开发人员组,

然后创建此组｡

正如你所看到的, 我不能创建它,

因为我不允许实际创建一个组｡

我只能在IAM上读

因此, 由于我具有只读访问权限,

因此无法创建组｡

所以这表明你只能允许用户做他们应该做的事情｡

当然, 如果我想在右侧授予创建组的权限,

我需要附加更大的权限集, 例如IAM完全访问权限｡

接下来, 让我们做点什么｡ 

接下来, 我将进入左手边的用户组,

我将创建一个组｡

所以这个群体将被称为开发者｡ 

然后我将在这个组中添加用户Stephane, 并将附加我能找到的任何策略,

例如AlexaForBusiness,

但这并不重要｡

只需附加第一个策略, 然后让我们创建此组｡

好的, 这是添加的｡ 

最后, 让我们进入管理组｡ 

同样, 我们将添加用户并将Stephane重新添加到这个组中｡

现在, 如果我们回到Stephane用户,

让我们进入IAM, 看看用户, 看看Stephane, 我将关闭右边的消息｡

所以如果我们把Stephane看作用户, 正如我们所看到的,

我们有三个权限策略附加到我的用户｡

我们拥有从组admin继承的管理员访问权限｡

我们有这个AlexaForBusiness管理的政策,

已通过组开发人员附加｡

最后是直接附加的IAM ReadOnlyAccess｡

正如你所看到的,

我继承了不同的权限, 这取决于它是如何附加的｡

那么现在我们来详细看看政策｡ 

在左边, 让我们看看政策｡ 

首先, 让我们来看看这个管理员访问策略｡

所以如果我们看一下它, 它是给我们管理员访问一切的权限｡

如果您将此策略中定义的权限作为摘要查看,

正如您所看到的, 这允许AWS中的所有服务｡

这个数字可以随着时间的推移而变化｡ 

无所谓了

该课程将是最新的｡ 

因此, 所有这些服务, 例如, App Mesh或Alexa for

Business或Amplify, 它们都具有完全访问权限｡

那么, 这种权限是如何定义的呢？

如果你点击JSON, 这是这个策略的JSON格式,

我们可以看到这里有allow Action, star和resource,

star｡

所以AWS中的星意味着任何东西｡ 

这意味着我们允许对任何资源进行任何操作｡ 

当然, 允许对任何资源进行任何操作与授予管理员对某人的访问权限是完全一样的｡

这就是它的定义｡ 

如果我们看一下另一个策略, 例如,

我们之前看到的IAM ReadOnlyAccess｡

因此, 如果我们查看它, 我们会看到IAM被授权使用Full：List和Limited：Read｡

如果我点击它, 你就可以看到所有的API调用,

这些调用都是作为这个策略的一部分被允许的,

这是非常方便的｡

但是如果我们看看它是如何定义的, 让我们点击JSON｡

这里我们有一个JSON文档, 它显示了如何定义它｡

所以效果是允许, 然后我们列出允许的API调用｡

所以我们有这个, 这个, 然后我们有Get*.

所以当你有Get* 时, 它说任何以Get开头然后有后面的东西的东西都是授权的｡

例如, 获取用户或获取组｡ 

名单也一样｡ 

我们有一个列表 *｡ 

因此, 列出用户或组｡ 

因此, 通过使用星号,

我们将许多API调用包含并分组在一起｡

所以所有这些都允许在Resource* 上使用｡ 

因此, 这总结了只读IAM访问策略的组成部分｡

所以这是非常方便的｡ 

您也可以创建自己的策略｡ 

所以让我们创建一个策略,

我们有一个可视化编辑器或JSON编辑器｡

所以如果你有JSON, 你可以非常简单地编辑它, 然后用这个构建器创建你的JSON文档,

这非常方便｡

或者你可以使用可视化编辑器｡ 

例如, 假设IAM, 我们想为IAM创建东西｡

我们要授权什么行动？

我们想授权ListUsers｡ 

所以我们要把这个和GetUser｡ 

所以只有两个API调用｡ 

正如我们所看到的, 我们已经从list中的38个中选择了一个,

从read中的32个中选择了一个｡

那我们要授权给谁

是所有资源还是特定资源？

这是一个非常简单的, 但正如你所看到的,

这个构建器非常方便｡

当你点击下一步时, 你可以看一下,

然后说我的名字｡

然后我们制定了这个政策｡ 

如果我们看一下我们创建的策略, 我们可以看一下相应的JSON,

并看到确实通过可视化编辑器, 我们允许在Resource*

上使用iam：ListUsers和iam：getUser｡

然后这个策略, 我们可以附加到组或用户等等｡

这就是您在AWS中管理权限的方式｡ 

现在结束这个实践, 让我们转到用户组,

我们将删除开发人员组, 因为我们不需要它｡

然后我将进入我的Stephane用户,

我将删除这个直接连接的IAM ReadOnlyAccess｡

所以现在Stephane只属于admin组,

它具有管理员访问权限｡

所以, 当然, 如果我回到我的IAM控制台在这里,

我只是看看用户, 正如你所看到的, 是的, 一切都显示正常｡

所以它工作正常｡ 

好了, 这节课就到这里了｡ 

希望你们喜欢, 下次课再见｡

---
source: 08 - High Availability and Scalability ELB & ASG\018 Auto Scaling Groups - Scaling Policies Hands On_zh.srt
---

# ASG 扩缩策略实操

## 学习目标
- 创建目标跟踪策略
- 触发扩容并验证告警

## 重点速览
- 目标跟踪会自动创建 CloudWatch 告警
- 提升 CPU 负载可触发扩容
- Activity/Monitoring 可验证扩缩结果

## 详细内容
创建策略：
1. 在 ASG 中选择 **Dynamic scaling**。
2. 选择 **Target tracking**，例如目标 CPU `40%`。
3. 保存后会自动创建高/低两个告警。

设置容量边界：
- 设定 `Max` 大于 `Min`（如 `Min=1, Max=3`）。

触发扩容：
1. 登录实例并制造 CPU 压力（如使用 `stress`）。
2. 在 **Activity history** 中查看扩容事件。
3. 在 **Instance management** 中确认实例数量增加。

验证告警：
- 在 CloudWatch Alarms 中查看 `AlarmHigh/AlarmLow`。

## 自测问题
- 目标跟踪策略会自动创建哪些告警？
- 为什么必须设置 Max 大于 Min？

这个实例处于警报状态,

由于指标本身进入警报状态, CPU利用率超过了此处的限制, 它被触发了, 这使我的自动扩展组发生了扩展活动,

进而使一个新实例投入使用｡

现在, 如果我转到这里并停止此命令, 我甚至不确定是否可以停止它,

但如果我停止此命令或让我完成它并停止此命令,

我可能可以转到我的EC2实例并重新启动它｡

所以我会看一下这个, 我相信, 我会重新启动它｡

因此, 重新启动这个实例,

我也将重新启动那个实例, 以防万一｡

这应该会使CPU利用率回到零,

并在15分钟内触发一个秤｡

我将再次暂停ASG中的视频, 看看是否有机会在活动中看到正在进行的规模｡

我现在暂停一下, 实际上只是因为我的速度不够快,

因为CPU仍然很高, 所以所需的容量从两个变成了三个｡

因此, 我们可以看到又添加了一个实例｡ 

这确实显示了自动扩展组的强大功能｡

现在, 如果我进入实例管理,

我们将有三个EC2实例, 我将不得不等待一段时间, 直到它们被终止｡

现在让我们回到活动中来, 正如您所看到的,

更多的活动正在进行｡

因此, 某些实例已终止｡ 

因为警报来自较低的CPU, 然后容量从3设置为2,

然后再一次从2设置为1｡

如果进入实例管理,

您会看到, 一个实例已终止,

另一个实例处于终止阶段, 因为这意味着您的目标跟踪策略正在工作｡

你可以通过这里的警报器看到｡ 

正如您所看到的, CPU利用率先是上升,

然后下降, 一旦超过28%的阈值, 就会进入警报状态, 这意味着您的ASG将开始删除实例｡

这就显示了目标跟踪策略的威力｡ 

完成后, 请确保删除此策略, 这样您就可以进行清理了｡

就这样, 我们下节课再见｡

---
source: 26 - AWS Security & Encryption KMS, SSM Parameter Store, Shield, WAF\009 SSM Parameter Store Hands On (CLI)_zh.srt
---

- ：因此, 让我们使用Systems Manager参数存储｡ 

为此, 我只需键入parameter, 它会直接将我带到Systems

Manager｡

您也可以键入systems manager来查找UI｡ 

现在, 在Systems Manager中,

要找到参数存储区,

您必须在左侧向下滚动, 然后在此处找到倒数第二个参数存储区｡

因此, 参数存储区用于机密和配置数据管理,

它是一种将所有这些参数集中在AWS帐户中的方式, 这很棒｡

在这里你可以看到它是如何工作的｡ 

创建一个新参数,

然后指定参数的类型和值,

并在代码的命令中引用该参数, 这正是我们要做的｡

因此, 要开始, 请单击“创建参数”｡

因此, 我将在这里创建一个名为my-app的参数,

它位于开发环境中｡

第一个是数据库URL｡ 

我会说开发中的应用程序的数据库URL｡ 

好吧, 我会的

这里我们有三种类型, 我们有一个字符串,

我们可以放置任何字符.

StringList, 你有一个用逗号的字符串列表,

或者SecureString, 它是加密的｡

我们先来看看String｡ 

例如, 这是一个数据库URL｡ 

所以你可以输入任何你想要的内容,

但必须是4096个字符｡

我们继续说, 德夫｡

数据库中｡  斯蒂芬老师｡  com的网站｡ 

这是非常随机的,

也许我会添加端口3306｡

所以你想怎么做就怎么做, 好吗｡ 

这是一个随机的网址,

Dev. 数据库中｡  斯蒂芬老师｡  com：3306｡ 

我将继续创建参数｡ 

在这里, 创建参数请求成功了｡ 

我们有了第一个参数

结果我们可以看到描述､

类型和版本｡

因此, 如果我们修改此参数, 我们将获得一个新的最后修改数据,

以及将跟踪的最后修改用户, 以便我们可以知道谁修改了什么｡

如果我单击此按钮, 您将再次看到一个摘要｡ 

您可以看到值的历史记录,

也可以看到标记｡

我们有了数据库网址｡ 

我想创建另一个参数, 这次我将创建一个参数,

将其命名为数据库的db-password｡

我只需要输入我正在开发的应用程序的数据库密码｡

这里我有一个SecureString,

所以这次我们要加密我们的秘密｡

因此我们将使用KMS进行加密｡ 

我们可以用活期账户或其他账户｡ 

对于我们的KMS密钥源, 我们将使用我们的当前帐户｡ 

我们可以使用AWS提供的密钥, 当然, 我们也可以使用之前创建的密钥,

因此, 我创建了之前的教程KMS密钥｡

所以我们也可以用这个｡ 

您可以根据自己的安全管理方式选择任何选项｡

所以我会用我的教程｡ 

这是它的值｡ 

我会说, 这是开发人员的密码｡ 

我们看不到它, 因为它是一个秘密值,

它会被加密｡

因此, 我将创建参数｡ 

现在, 我们看到这里有一个新参数, 称为dev/db-password｡

它现在是一个SecureString, 这意味着它是加密的,

密钥ID是alias/tutorial, 版本是1｡

如果我单击它, 我们可以看到该值是隐藏的,

但我可以单击“显示”,

这将为我即时解密该值, 并说这是开发密码｡

这很酷, 因为我们能做的就是复制这些,

所以我们会再做一次, 但这次是在prod中｡

让我们继续创建参数｡ 

我将在prod中创建它｡ 

我只需要稍微更改一下路径,

我会说数据库URL,

即我的应用程序在生产中的URL｡

我会很快的,

普德｡ 数据库中｡  斯蒂芬老师｡  com：3306｡ 

我来创造它｡ 

我将创建最后一个参数｡ 

我们将在prod中创建db-password,

并在生产和SecureString中提供描述,

我将使用相同的教程值, 在这里我将输入prod password｡

我将建立参数｡ 

现在我们有四个参数,

我们希望能够访问它们｡

因此, 我们可以先使用此CLI访问它们｡

因此, 我们将使用此CLI来获取参数｡ 

因此它被称为get参数｡ 

你必须提供一个名称, 为此我们必须提供我们想要的参数的名称｡

所以对我来说, 我只需要输入我的db-url和db-password,

然后按Enter键｡

现在我们从API返回两个结果｡ 

我们得到了数据库密码和数据库网址｡ 

我们来看看结果｡ 

第一个是db-url的字符串, 这里是字符串的值｡

正如你所看到的, 因为它没有加密,

这个值被解密了, 版本是1｡

这很好, 我们可以看到数据库URL并使用它｡ 

但对于密码来说, 它是一个SecureString,

这里是它的值, 一个加密的值.

因此, 你基本上需要解密它｡ 

对于这个, 你有一个特殊的参数, 它叫做with-decryption,

所以我就用with-decryption来做｡

因此, 这将检查我是否有KMS权限来解密这个用KMS教程密钥加密的秘密｡

因此按Enter键｡ 

现在, 对于我的SecureString,

该值已经被解密, 因为我指定了with-decryption参数｡

这很酷, 因为很快,

我们就可以得到加密的值,

人们无法访问它们, 因为他们无法访问保护我密码的KMS｡

但是如果我可以访问KMS,

我只需要提供一个额外的标志-解密, 现在, 我得到了我的dev密码的值｡

所以它真的, 真的很整洁｡ 

我们可以做的另一件事是执行aws

ssm get-parameters-by-path, 然后转到帮助｡

所以get-parameters-by-path允许我们遍历一个路径,

我们必须提供路径名｡

而且必须以正斜杠开头｡ 

所以如果我们通过路径获取参数,

我会删除它, 我只会保留my-app/dev/｡

我会说, 按路径获取参数, 路径是这样的｡

然后, 它将查询此路径下的所有参数｡

这就是为什么我们有一个树形结构｡ 

而我们从中得到的, 显然, 是依赖于我们之前所拥有的｡

我们现在要做的就是上一层, 只用到my-app,

然后递归地得到my-app下的所有参数.

按Enter键, 现在我们得到了四个参数, db-password､

db-url､ 用于prod的db-password和用于prod的db-url｡

所以使用这个树形结构,

我们基本上可以组织我们的秘密, 并且一次得到所有的秘密,

这真的很简单｡

原来如此｡ 

显然, 您也可以提供with-decryption标志并获得解密｡

以上仅针对CLI, 在下一节课中,

我将向大家展示它如何与AWS

Lambda配合使用,

因为它也非常简单｡

所以下节课再见｡

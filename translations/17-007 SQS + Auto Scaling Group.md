```markdown
**学习目标**

- 理解如何将 Amazon SQS 与 Auto Scaling Group (ASG) 配合使用以按需扩展消费者。
- 掌握基于队列指标触发扩缩容的常见架构模式与考点。

**重点速览**

- 使用 CloudWatch 指标（ApproximateNumberOfMessagesVisible）监控队列长度，作为触发 ASG 扩容/缩容的依据。
- 常见模式：前端将请求写入 SQS，后端 ASG 中的消费者读取并写入数据库，实现削峰与解耦。

**详细内容**

- 架构说明：前端服务将事务或任务入队（SQS），消费者运行在 ASG 中并轮询队列。通过 CloudWatch 报警（如队列长度超过阈值）触发 ASG 扩容策略；处理完成后消费者调用 DeleteMessage 删除消息。
- 优点：可吸收突发流量、避免数据库过载、保证消息耐久性与最终一致性；适用于不需要同步确认数据库写入即可返回客户端的场景。
- 实施要点：合理设置可见性超时、长轮询和批处理以提高效率；通过队列深度指标配合 CloudWatch 警报与 ASG 策略实现自动扩展；考虑死信队列（DLQ）和重试策略以处理失败消息。

**自测问题**

1. 描述 SQS + ASG 模式如何帮助处理突发写入流量？
2. 用哪个 CloudWatch 指标作为扩展消费者的触发器？为什么需要设置可见性超时？

```

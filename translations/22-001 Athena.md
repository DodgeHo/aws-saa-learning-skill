---
source: 22 - Data & Analytics\001 Athena_zh.srt
---

演讲者：那么现在, 让我们来谈谈亚马逊雅典娜｡ 

Athena是一个无服务器查询服务,

可以帮助您分析存储在AmazonS3存储桶中的数据｡

为了分析这些数据,

您将使用标准SQL语言来查询文件｡

在幕后, Athena是基于Presto引擎构建的,

该引擎使用SQL语言｡

因此, 我们的想法是, 用户将数据加载到您的S3存储桶中,

或者您将数据加载到您的S3存储桶中, 然后您将使用Athena服务在Amazon

S3中查询和分析此数据, 而无需移动它｡

因此, Athena是无服务器的,

它直接分析您S3存储桶中的数据｡

因此, 它支持不同的格式,

如CSV, JSON, ORC, Avro和Parquet,

以及其他格式｡

而且定价非常简单｡ 

您只需为每TB扫描的数据支付固定金额｡

您不需要再次提供任何数据库,

因为整个服务是无服务器的｡

因此, Athena通常与另一个名为Amazon

QuickSight的工具一起使用, 以创建报告和仪表板｡

稍后我们将深入了解Quicksight, 但Amazon

Quicksight连接到Athena, 后者连接到您的S3存储桶｡

现在, Amazon Athena的用例是执行即席查询､

商业智能､ 分析､ 报告, 以及分析和查询来自AWS服务的任何类型的日志｡

因此, 它可能是您的VPC流日志､

负载均衡器日志､ CloudTrail踪迹等｡

因此, 作为一个考试提示,

任何时候您需要使用无服务器SQL引擎分析AmazonS3中的数据,

您都可以考虑使用Athena｡

现在, 我已经谈到了性能改进, 你实际上可以提高Athena的性能,

在这次考试中, 我们也会在这方面对你进行测试｡

首先, 因为您要为每TB扫描的数据量付费,

所以您需要使用一种您将扫描较少数据的数据类型｡

为此, 您可以使用柱状数据类型来节省成本,

因为您只扫描需要的列｡

因此, Amazon Athena的推荐格式将是Apache

Parquet和ORC, 它将为您带来巨大的性能提升｡

要将文件转换为Apache Parquet或ORC格式,

必须使用本节中介绍的服务, 例如Glue｡

Glue对于将数据转换为ETL作业非常有用,

例如在CSV和Parquet之间转换｡

现在, 也因为我们想要扫描更少的数据, 我们需要压缩数据以进行更小的检索｡

因此, 有不同的压缩机制, 你可以使用,

已经列出了它的权利在这里｡

接下来, 如果你知道你将一直查询一些特定的列,

你可以划分你的数据集,

划分数据集意味着在你的S3桶中, 你将拥有带斜线的完整路径,

每个斜线将是一个不同的列名,

有一个特定的值｡

因此, 您在Amazon

S3中对数据进行组织和分区, 以便在查询数据时, 您可以确切地知道在Amazon

S3的哪个路径的哪个文件夹中需要扫描数据｡

这是一个数据分区的例子｡ 

所以我们有Parquet格式的飞行数据,

然后我们做/年=1991｡

所以我们按年划分,

每年有一个文件夹｡

然后在每一年里我们有月, 所以月等于1,

在每一个月里我们有天,

这等于1.

因此, 当我在Athena上执行查询时,

我会筛选特定的年份､ 特定的月份和特定的日期,

然后我们会确切地知道从Amazon S3中的哪个文件夹获取数据, 因此我们只会恢复数据的一个子集｡

因此, 我们会有非常非常好的分区｡ 

最后, 你需要做的最后一个性能改进是使用更大的文件,

这是为了最小化你的开销｡

因此, 如果您在Amazon S3中有很多很多小文件,

Athena的性能就不会像您有更大的文件（例如128

MB及以上）一样好, 因为更大的文件更容易扫描, 也更容易检索｡

Amazon Athena的另一个功能是Federated Query｡ 

所以你知道Athena可以在S3中查询数据,

但实际上你可以在任何地方查询数据,

例如, 在关系或非关系数据库中, 你可以查询对象和自定义数据源, 无论是在AWS上还是在本地｡

怎么做？ 您使用的是所谓的数据源连接器｡ 

这是一个Lambda函数,

该Lambda函数将在其他服务中运行联邦查询｡

例如, 这可能是CloudWatch Logs､ DynamoDB､

RDS等｡

所以它非常强大｡ 

例如, 我们这里有Athena,

我们有一个Lambda函数,

每个数据源连接器都有一个Lambda函数｡

然后通过Amazon Athena,

您可以在EMR服务上的ElastiCache､

Document DB､ DynamoDB､ Redshift､

Aurora､ SQL Server､ MySQL､ HBase或任何本地数据库上运行查询｡

它们来自Athena,

当然还有Amazon S3,

你可以画画, 你可以比赛,

等等｡

这就是它被称为联合查询的原因｡ 

然后, 可以将此查询的结果存储到Amazon

S3存储桶中, 以供以后分析｡

这就是亚马逊雅典娜｡ 

如你所见, 这是一个非常强大的服务｡ 

我希望你们喜欢,

我们下节课再见｡

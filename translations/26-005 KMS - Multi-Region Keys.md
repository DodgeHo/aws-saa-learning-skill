---
source: 26 - AWS Security & Encryption KMS, SSM Parameter Store, Shield, WAF\005 KMS - Multi-Region Keys_zh.srt
---

- ：现在我们来讨论一下KMS多区域密钥｡ 

因此, 我们有KMS, 并且实际上可以有多区域密钥｡ 

这意味着您将在一个选定的Region中拥有主键,

例如us-east-1｡

然后, 该密钥将被复制到其他地区｡

例如, 美国西部-2､ 欧洲西部-1和亚太东南部-2｡ 

所以相似之处在于关键材料会被复制｡

其他地区也将使用相同的密钥｡ 

密钥ID将完全相同｡ 

如您所见, 密钥ID和mrk以及所有区域中相同的内容｡

这就是KMS多区域密钥背后的原理｡ 

那么, 你会用它们做什么呢？

这是一组KMS密钥, 您可以在不同的AWS区域使用,

并且它们可以互换使用｡

因此, 这意味着您可以在一个区域加密,

然后在另一个区域解密｡

而多区域密钥则是可能的, 因为它们具有相同的密钥ID和相同的密钥材料｡

如果您为主键启用了自动旋转,

并且它实际上进行了旋转,

那么它也将被复制到其他区域｡

因此, 使用多区域密钥, 您可以在一个区域中加密并在另一个区域中解密,

因此, 在从一个区域移动到下一个区域时, 您不需要重新加密数据;或进行跨区域API调用｡

因此, 需要了解的是,

KMS多区域密钥不是全局的｡

好吗？ 您拥有主服务器和副本服务器｡ 

每个多区域密钥都将使用其自己的密钥策略进行独立管理,

依此类推｡

因此, 不建议使用多区域密钥, 除非在非常特定的用例中,

因为KMS喜欢将密钥绑定到单个区域｡

因此, 使用多区域密钥的使用情形是,

如果您希望有一个全局客户端加密｡

因此, 能够加密一个区域中的客户端,

并解密另一个区域中的客户端｡

或者对全局DynamoDB表或全局Aurora进行加密｡

我们马上就能看到｡ 

那么, 在DynamoDB中使用全局表和KMS多区域密钥以及客户端加密时,

它是如何工作的呢？

因此, 您需要加密的不仅仅是整个表,

因为这是有风险的加密｡

您希望加密表上的实际属性｡ 

所以它们只提供给特定的客户｡ 

甚至对数据库管理员也是如此｡ 

为此, 我们将使用Amazon

DynamoDB加密客户端｡

让我们举一个例子, 我们有美国东部1和亚太东南部2｡

因此, KMS服务具有复制到另一个区域的多区域密钥｡

南-东南-2区｡ 

并且客户端应用程序希望将数据插入DynamoDB表｡

因此, 首先将使用主多区域密钥加密需要加密的属性｡

因此, 我们的想法是DynamoDB表中的大多数字段不会在客户端加密｡

好吧, 我会的

但其中一个, 例如社会安全号码,

将被加密｡

这很好, 因为访问DynamoDB表的数据库管理员,

如果他们没有访问KMS密钥的权限,

我们将使用该密钥加密一个属性, 即社会安全号码｡

那么他们将无法访问它｡ 

因此, 它甚至可以针对数据库管理员提供保护｡

因此, 如果此DynamoDB表恰好是全局表,

则此数据将被复制到另一个区域｡

所以现在是在ap-south-2｡ 

幸运的是, 我们已经决定使用Multi-Region密钥加密数据和属性｡

因此, ap-seastern-2区域中的客户端应用程序可以检索该行,

查看一个属性是否被加密,

然后执行API调用以使用复制品多区域密钥实际解密该属性｡

这就是为什么我们在此实例中使用多区域关键点｡ 

是不是这样, ap-seastern-2中的客户端应用程序就可以对KMS执行本地API调用,

以解密该属性｡

因此, 使用这种客户端加密技术, 我们可以保护数据上的特定字段或属性,

并且仅在客户端可以访问API密钥时才保证解密｡

借助全局表, 我们可以确保同时复制数据和加密密钥｡

因此, 同样的概念也适用于全球极光｡ 

所以我会走快一点｡ 

这一次, 我们将使用AWS加密SDK｡ 

因此, 我们有两个区域,

KMS中有一个跨这两个区域复制的多区域密钥｡

因此, 客户端应用程序希望加密一个尚未获得SSN列的列｡

这一次我们将数据放入一个带有表的Amazon Aurora数据库中｡

所以这一行上的所有数据都是未加密的,

除了一列, 即SSN, 它实际上是用mrk,

即多区域密钥加密的｡

这是一个全局数据库｡ 

这意味着表将被全局复制｡

因此, 同样的数据将发生在ap-seouthern-2｡

因为我们的客户端在ap-seastern-2中,

他们将从您的表中获取这些加密数据｡

由于我们使用的是多区域密钥, 因此他们可以对KMS执行本地API调用来解密此属性｡

因此, 我们实现了更低的延迟｡ 

我们已经看到, 使用客户端加密, 我们还可以保护这些数据,

甚至可以防止数据库管理员访问这些数据｡

因此, 如果您的数据库管理员访问Amazon

Aurora数据库, 并希望访问社会安全号码这一列｡

除非他们可以访问KMS密钥,

否则他们将无法读取此数据,

这是非常有帮助的｡

以上就是KMS多区域密钥｡ 

希望你喜欢｡ 

我们下节课再见｡

---
source: 14 - Amazon S3 Security\003 S3 Encryption - Hands On_zh.srt
---

Stephane：那么让我们练习加密｡ 

为此, 我将创建一个名为demo-encryption-stephane-v2的存储桶｡

我们向下滚动, 我们要让这个开着,

让这个开着｡

我们将启用存储桶版本控制｡ 

然后在默认加密下, 正如我们所看到的,

我们有三个不同的选项,

但我们必须为我们的桶选择默认加密｡

因此, 我现在将介绍SSE-S3,

稍后我们将了解SSE-KMS和DSSE-KMS｡

所以让我们点击Create a bucket｡ 

现在, 我们已经创建了一个启用了默认加密的存储桶｡

让我们通过实际上传一个对象来验证这一点｡ 

所以我们要添加一个文件,

我们将添加我们的咖啡｡ jpg文件｡ 

然后我们点击上传｡ 

正如你现在看到的, 我可以点击这个文件并向下滚动,

查找服务器端的加密设置｡

事实上, 该文件是使用Amazon

S3托管密钥（SSE-S3）通过服务器端加密进行加密的｡

我们还可以编辑文件的加密机制｡ 

所以我可以点击编辑｡ 

正如你所看到的,

如果我们编辑服务器端加密, 那么这将创建一个具有更新设置的新版本的对象｡

因此, 这就是为什么我为我的bucket启用了版本控制,

是为了向您展示将创建文件的新版本｡

所以我们换个加密方式｡ 

为此, 我们将覆盖此对象的默认加密的存储桶设置｡

因此, 我们可以选择使用SSE-KMS或DSSE-KMS｡

所以DSSE-KMS, 我不会在这上面花很多时间｡ 

只是KMS的两级加密｡ 

更强的KMS｡ 

我们现在就使用KMS｡ 

它更简单, 而且不会花费我们任何钱｡ 

因此, 我们将使用我们学到的SSE-KMS｡ 

然后我们必须指定一个KMS密钥｡ 

因此, 我们可以输入KMS密钥ARN, 也可以从您自己的KMS密钥中进行选择｡

因此, 如果我们现在从KMS密钥中选择,

您应该只有一个密钥可用AWS/S3密钥,

它被称为S3服务的默认KMS密钥｡

如果你点击它, 我们就可以用这个键｡ 

这不会花费我们任何钱,

因为这是服务的默认密钥｡

如果您创建了自己的KMS密钥,

则它将在此列表中可用｡

但创建自己的KMS密钥将花费你一些钱每个月｡

因此, 出于此目的,

我们将使用默认的AWS/S3 KMS密钥｡

好吧, 那我们就把改动存起来吧｡ 

我们关闭它, 现在如果我们转到“版本”下,

正如我们所看到的, 我们现在有两个可用的文件版本｡

因此, 当前版本, 如果我们向下滚动并进入服务端加密,
## 学习目标

- 理解 S3 的服务器端加密选项：SSE-S3、SSE-KMS、DSSE-KMS 以及 SSE-C 的限制。
- 会在控制台开启存储桶默认加密并验证对象使用的加密方式。
- 能覆盖单个对象的加密设置并理解版本化与加密的关系。

## 重点速览

- 控制台可用的默认加密：SSE-S3、SSE-KMS、DSSE-KMS（SSE-C 只能通过 CLI 使用）。
- 对象可继承桶的默认加密，也可以为单个对象覆盖为 SSE-KMS（需指定 KMS Key）。
- 使用自带 KMS 密钥会产生费用；AWS/S3 默认 KMS 密钥可免费使用。
- 启用版本控制后，修改对象加密会生成新版本，可用于验证加密更改。

## 详细内容

1. 创建存储桶并启用默认加密
- 在创建桶时可以设置默认加密（SSE-S3 / SSE-KMS / DSSE-KMS）。默认情况下 S3 使用 SSE-S3。可修改为 SSE-KMS 以使用 KMS 管理密钥。

2. 上传并验证对象加密
- 上传对象（例如 coffee.jpg）后，在对象属性中查看“服务器端加密”字段。若使用桶默认加密，字段会显示 SSE-S3 或 SSE-KMS 等。

3. 覆盖单个对象的加密
- 编辑对象属性可为该对象指定不同的加密方式（例如从 SSE-S3 切换到 SSE-KMS）。修改后会生成该对象的新版本（因此需要开启版本控制以便观察差异）。
- 选择 SSE-KMS 时需指定 KMS key。控制台上会列出 AWS/S3 的默认 KMS key（免费），以及用户创建的自定义 KMS key（可能产生成本）。

4. 桶密钥与成本优化
- 对于 SSE-KMS，可启用桶密钥（Bucket Key）以减少对 AWS KMS 的请求次数，从而降低成本。SSE-S3 不计入 KMS 请求，桶密钥也不适用于 SSE-S3。

5. 其他加密方式说明
- SSE-C（客户提供密钥）无法通过控制台设置，只能通过 CLI/API 使用。
- 客户端加密：数据在客户端加密并上传，S3 无需知道对象已被客户端加密，解密也要在客户端完成。

## 自测问题

1. 控制台上可以为桶设置哪些默认加密选项？哪个选项需要指定 KMS key？
2. 如果把对象从 SSE-S3 改为 SSE-KMS，会发生什么？如何验证？
3. SSE-C 可以通过控制台启用吗？为什么？
4. 什么是桶密钥（Bucket Key），它解决了什么问题？

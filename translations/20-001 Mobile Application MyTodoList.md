---
source: 20 - Serverless Solution Architecture Discussions\001 Mobile Application MyTodoList_zh.srt
---

好的, 现在我们来讨论一下无服务器架构｡ 

现在, 我们将创建一个名为MyTodoList的移动应用程序｡

因此, 我们需要满足以下要求：我们需要公开一个具有HTTPS端点的REST

API, 我们需要采用无服务器架构, 并且我们希望用户能够直接与S3中自己的文件夹进行交互, 以便在需要时管理其数据｡

而且用户还应该能够通过托管无服务器服务进行身份验证｡

最后, 用户可以写入和读取to-dos, 但他们主要是读取它们,

所以可能在性能方面有一些事情要做｡

数据库层应该可以扩展,

并且应该具有非常高的读取吞吐量｡

这是一个非常好的要求,

现在让我们看看如何实现｡

第一步是开始, 我们有一个移动客户端, 我们讨论过做一个休息HTTPS的事情,

所以让我们使用Amazon API网关来做这个｡

这是一个很好的方法｡ 

现在, 在一个经典的无服务器API方式中,

API Gateway将调用一个出借方函数,

该函数基本上允许我们扩展和使用无服务器基础设施｡

好的, Amazon Lambda需要能够从数据库中存储和读取to-do｡

DynamoDB是一个可伸缩性非常好的无服务器数据库｡

在这里, 我们将DynamoDB作为后端｡ 

现在, 我们说还会有某种身份验证层,

因此, 我们可以使用无服务器技术, 如Amazon Cognito｡

因此, 我们的移动客户端可以连接到Cognito并进行身份验证,

然后API Gateway将在此过程中验证Cognito的身份验证｡

因此, 这给了我们一个非常经典的无服务器API, 我们刚刚在这里创建了它｡

对你来说没什么新鲜事, 但很高兴再次见到你｡ 

现在, 如果您想授予用户访问Amazon S3 Locate的权限,

我们该如何操作？

我们有移动客户端, 它可以向Amazon

Cognito进行身份验证,

Cognito可以使用AWS STS为我们生成临时凭据,

并将这些凭据返回到我们的移动客户端｡

这些凭据允许我们的移动客户端在Amazon

S3中存储和检索文件, 并且基本上可以访问它们自己在S3中的小空间｡

因此, 这也是一个非常经典的问题,

如何做到这一点, 错误的答案是将AWS用户凭据存储在移动客户端上｡

你绝对不想这么做｡ 

您要做的是真正使用Amazon Cognito､

STS, 然后使用具有临时凭据的Amazon S3｡

这是个很常见的问题｡ 

接下来, 我们的应用程序将开始扩展｡ 

我们开始有更多的用户, 通过查看模式,

我们发现我们有非常高的读取吞吐量,

因此我们有许多RCU, 待办事项实际上没有太大变化, 它们不会经常被编辑｡

那么, 我们如何改变这种架构,

从根本上提高读取吞吐量, 并降低整体成本呢？

我们可以使用DAX作为缓存层, 因此,

在使用DynamoDB之前, 我们将使用DynamoDB

DAX, 它基本上具有一个缓存层, 由于我们要执行大量读取操作,

现在读取操作将缓存在DAX中,

因此, DynamoDB不需要那么多读取容量单位, 可能会更好地扩展, 可能会有更少的原因, 因为缓存了这么多读取操作,

总的来说, 这是一种很好的方法, 以无服务器的方式不断改进我们的架构｡

现在, 可能还有另一种缓存方式,

您可能希望使用DAX, 但我们也可能希望在Amazon

API Gateway级别开始缓存响应｡

这也是我们可以做的事情｡ 

如果您认为答案永远不会真正改变,

并且您可以开始缓存一些API路由的一些响应,

那么这也是一个非常好的选择｡

总的来说, 看到这种体系结构真的很有趣,

因为它们向您展示了无服务器是如何实现的,

缓存是在哪里出现的, 在这种体系结构中, 我们不管理任何东西, 我们真的按使用量付费,

我们真的不考虑数据库的管理｡

这些都是AWS为我们做的｡ 

因此, 在本讲座中,

我们了解了经典的无服务器REST API架构, 基本上利用了HTTPS､

API网关､ Lambda和DynamoDB｡

然后, 我们使用Cognito生成了带有STS的临时凭证,

这使我们能够访问带有受限策略的额外存储桶｡

我们可以使用完全相同的应用程序模式使用Cognito,

所以我们的应用程序可以直接访问DynamoDB或Lambda等｡

这是一种非常常见的模式｡ 

现在, 可以使用DAX在DynamoDB上缓存读取,

这是一种非常简单的启用方式, 您不仅可以提高性能,

还可以降低成本, 如果我们有非常静态的响应, 则可以在API网关级别缓存REST请求｡

最后, 整个过程的安全性都可以通过Cognito来实现,

Cognito直接与API网关集成｡

这是一个非常基本的示例,

但它为我们提供了一个无服务器架构的基本起点,

并向我们展示了我们在上一节中看到的所有不同组件｡

我希望这能有所帮助, 下节课再见.

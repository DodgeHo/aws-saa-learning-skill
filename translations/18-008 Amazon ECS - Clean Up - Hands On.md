**学习目标**
- 掌握清理 ECS 环境（服务、集群、ASG、容量提供者）的标准步骤
- 理解 CloudFormation 在删除资源时的作用与影响

**重点速览**
- 停止服务：将服务的期望任务数设为 0，然后删除服务
- 删除服务通常会触发 CloudFormation 删除堆栈，移除 ALB、目标组、SG、ASG 等资源
- 可选择保留或注销任务定义（不收费但可清理）

**详细内容**
清理流程建议：
1. 在 ECS 控制台中把对应服务的期望任务数改为 0，等待任务停止。
2. 删除 ECS 服务；若服务由 CloudFormation 创建，删除服务会触发对应堆栈的删除流程，CloudFormation 会依次删除 ALB、目标组、安全组、ASG、容量提供者等依赖资源。
3. 服务删除完成后，可删除集群（Delete Cluster），这会清理集群级别的配置与关联资源。
4. 任务定义是描述性配置，不会产生费用，可选择注销（deregister）以便清理控制面显示。

**自测问题**
- 删除 ECS 服务通常会触发什么操作？
- 为什么要先把期望任务数设为 0 再删除服务？
- 任务定义删除后是否会产生费用？
---
source: 18 - Containers on AWS ECS, Fargate, ECR & EKS\008 Amazon ECS - Clean Up - Hands On_zh.srt
---

教练：所以在我们完成之前, 让我们确保摧毁一切｡

首先, 我们需要停止服务｡ 

因此, 要停止服务,

请确保您没有运行任何任务｡

如果没有, 则更新服务并将所需任务设置为零｡

然后你可以点击删除服务, 输入删除,

这将删除服务｡

现在, 当您删除服务时,

这实际上将进入一个名为CloudFormation的服务｡

CloudFormation将花时间删除它创建的整个堆栈｡

因此, 它要删除的部分内容是ECS服务,

但也包括LoadBalancer服务器､ LoadBalancer本身､ 安全组和目标组｡

所以这可能需要一点时间,

我们需要等待所有内容都被删除｡

当服务被完全删除时,

您可以删除此群集｡

因此, 您只需单击Delete

Cluster, 它就会删除演示群集｡

我们现在就可以做｡ 

同样, 这将在CloudFormation中启动一些东西来删除ECS集群的基础设施｡

这包括容量提供者､

我们创建的自动伸缩组､

集群和启动模板｡

所以这很好｡ 

最后, 对于您的任务定义, 您可以保持它们不变｡ 

它们不花你任何钱, 它们只是定义｡ 

但如果你愿意,

你也可以点击其中一个并注销｡

执行Action并注销测试定义本身｡ 

就这样

希望你们喜欢, 下次课再见｡

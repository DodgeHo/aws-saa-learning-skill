---
source: 26 - AWS Security & Encryption KMS, SSM Parameter Store, Shield, WAF\003 KMS Overview_zh.srt
---

解说员：现在我们来谈谈AWS

KMS, 它是AWS的密钥管理服务｡

所以我们一直在使用它, 你知道,

很多时候你不知道, 但每当你听到加密时, 你有一个AWS服务,

它最有可能是KMS加密｡

我们的目标是, 通过这个KMS服务,

AWS将为我们管理加密密钥｡

这很好, 因为这意味着我们有更少的事情要做｡

因此, KMS当然与IAM完全集成以进行授权,

如果数据使用KMS加密, 它为我们提供了非常简单的方法来控制对数据的访问｡

使用AWS KMS的强大之处在于, 您可以通过CloudTrail审核为使用密钥而进行的每一个API调用,

这可能是考试中要测试的内容｡

因此, 在它之上, KMS可以无缝地用于大多数AWS服务｡

例如, 如果您希望加密EBS卷中的静态数据,

只需启用KMS集成｡

S3､ RDS､ SSM以及几乎所有需要加密的服务都是如此｡

这个想法是, 有了KMS, 你也可以自己使用它｡ 

如果你有秘密数据, 你永远不会以纯文本的形式存储它们｡

这意味着一切照旧, 尤其是在代码中｡ 

所以如果你想使用KMS,

你也可以通过API调用来使用KMS｡

您可以使用AWS CLI或SDK｡ 

这意味着你可以用KMS密钥加密任何对你来说是秘密的东西｡

然后, 这些加密的秘密可以存储在代码或环境变量中｡

这是一个更好的模式｡ 

现在我们来讨论一下您可以使用的不同类型的KMS密钥｡

顺便说一下, 现在它被称为KMS密钥｡ 

它过去被称为KMS客户主密钥, 但这很容易混淆,

因为还有客户管理密钥,

我们稍后将看到｡

现在我们只讨论KMS密钥｡ 

因此, 我们有两种类型的KMS密钥｡ 

我们有对称的KMS密钥, 这意味着只有一个加密密钥用于加密和解密数据｡

因此, AWS的任何与KMS集成的服务都将使用对称密钥｡

其思想是, 当我们创建或使用KMS对称密钥时, 我们永远无法访问密钥本身,

对吗？

我们所做的就是使用KMS API调用来利用和使用该密钥｡

KMS上可用的第二种密钥称为非对称密钥｡

这意味着你有两把钥匙｡ 

您有一个用于加密数据的公钥和一个用于解密数据的私钥｡

因此, 当您执行加密/解密或签名/验证类型的操作时,

会使用此函数｡

在这种情况下, 您可以从KMS下载公钥,

但无法访问私钥｡

您只能使用API调用来访问私钥｡ 

非对称类型密钥的用例是当您希望无法或没有权限访问KMS

API密钥的用户在AWS云之外进行加密时,

在这种情况下, 他们将使用公钥加密数据, 然后将其发送给您,

而您将在您的帐户中使用AWS的私钥解密该数据｡

因此, 在KMS密钥的世界中,

您有不同类型的KMS密钥｡

第一个是AWS拥有的密钥｡ 

它们是免费的, 这是你在使用SSE-S3类型的加密或SSE-DynamoDB时会使用的密钥,

你可以选择, 例如, 你选择DynamoDB拥有的密钥｡

这些并不是真正的KMS,

因为您看不到它们,

但它们是AWS中的加密密钥类型｡

然后您有了AWS管理的密钥, 它们是免费的,

您可以认出它们, 因为它们以AWS､

斜杠和服务名开头｡

例如aws/rds或aws/ebs, 或者在本例中为aws/dynamodb｡

它们是免费的, 你可以随心所欲地使用它们,

但只能在分配给它的服务中使用｡

然后你就有了自己的客户管理密钥,

它们是自定义密钥, 每月要花1美元｡

如果你也想进口它们,

你可以进口它们, 它们每月花费你1美元｡

KMS也有一个定价, 您将为每个对KMS服务的API调用付费,

大约是每10, 000个API调用3美分｡

您还可以使用自动密钥轮换｡ 

因此, 如果它是一个AWS管理的KMS密钥,

那么它是自动的, 每1年｡

如果它是您在KMS中创建的客户管理密钥,

则必须启用自动轮换, 并且每1年轮换一次｡

如果它是导入的KMS密钥,

那么你只能手动旋转它｡

为此你需要利用一个化名｡ 

因此, KMS密钥的作用域是按区域划分的｡ 

这意味着, 如果我们在一个地区（例如eu-west-2）中有一个使用KMS密钥加密的EBS卷,

那么如果您要将其拷贝到其他地区, 我们必须执行几个步骤｡

首先, 我们必须拍摄此EBS卷的快照｡ 

如果我们从加密的快照中获取快照,

则此快照本身也将使用相同的KMS密钥进行加密｡

然后, 要将快照复制到另一个区域, 我们需要使用不同的KMS密钥重新加密快照｡

这是AWS将为您做的事情｡ 

但是同一个KMS密钥不能存在于两个区域中｡ 

现在我们有了EBS快照｡ 

它是用KMS用不同的密钥加密的,

它位于另一个区域｡

现在, 我们使用KMS将快照恢复到它自己的EBS卷中,

KMS密钥B位于区域ap-东南-2中｡

现在, 我们需要了解的另一件事是KMS的关键政策｡

这是为了控制对KMS密钥的访问｡ 

它类似于ASWS S3存储桶策略, 区别在于如果您的KMS密钥上没有KMS密钥策略,

则任何人都无法访问它｡

因此, 在这方面, 我们有两种类型的KMS关键策略｡ 

我们有默认的KMS密钥策略, 如果您不提供特定的自定义KMS密钥策略,

则会创建该策略｡

这个想法是默认的允许你账户中的每个人都可以访问这个密钥｡

这意味着, 如果您有一个IAM策略允许用户或角色访问这个密钥策略,

那么就可以了｡

但是, 如果您希望对其进行更具体的控制, 则可以使用自定义的KMS密钥策略,

在该策略中, 您可以为用户定义可以访问您的KMS密钥的角色｡

并且您定义谁可以管理密钥｡ 

如果您希望跨帐户访问您的KMS密钥,

这将特别有用, 因为我们可以授权另一个帐户使用我们的KMS密钥｡

我们什么时候用这个？

例如, 如果我们要跨帐户复制加密快照｡

因此, 我们创建了一个使用我们自己的KMS密钥加密的快照,

这是一个客户管理的密钥｡

一定是这样, 因为我们需要附加一个自定义密钥策略｡

然后我们附加一个KMS密钥策略来授权跨帐户访问｡

它看起来像这样｡ 

然后我们与目标帐户共享加密的快照｡

然后, 在目标帐户中, 我们创建快照的拷贝,

并在该目标帐户中使用另一个客户管理的密钥对其进行加密｡

然后, 我们可以从目标帐户中的快照创建卷,

这样就完成了｡

以上是KMS提供的大量信息,

但让我们开始实际操作, 希望能了解更多信息｡

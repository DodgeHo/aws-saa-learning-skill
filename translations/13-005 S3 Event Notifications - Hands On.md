---
source: 13 - Advanced Amazon S3\005 S3 Event Notifications - Hands On_zh.srt
---

教师：好的,

现在我们继续演示S3事件通知｡

为此, 我将创建一个桶｡ 

我称之为“史蒂芬-V3-事件-通知”然后当爱尔兰的...

我将继续创建一个完整的桶｡ 

好吧, 我会的 所以现在斗就产生了｡ 

我会深入研究的｡ 

我现在要做的是确保设置好事件通知｡

我进入“属性”,

向下滚动, 然后, 这里有事件通知｡

如你所见, 我们有两个选择｡ 

第一步是创建一个事件通知,

我稍后将向您展示这一点;第二步是启用Amazon

EventBridge集成,

将此S3存储桶中的所有事件发送到EventBridge｡

对于这个, 你只要你设置它,

你会很好去｡

所以现在如果我愿意的话, 我可以使用Amazon

EventBridge来捕捉我的S3桶中发生的事件｡

但我将向您展示一种更简单的方法,

因为它有点复杂, 即创建一个事件通知并将其发送到SQS｡

我将把它命名为“DemoEventNotification”,

然后我们可以设置一个前缀和后缀, 但我不会这么做｡

接下来, 我们来选择事件类型｡ 

所以我们要对所有对象创建事件做出反应｡ 

这就意味着, 只要创建了一个对象,

就会创建一个事件｡

但如果您愿意, 您可以获得更多的粒度,

并选择您想要的事件类型｡

但为了简单起见, 我还是在这里说吧｡ 

您还可以包括对象删除､

对象恢复等, 它在右侧显示了您可以捕获的所有事件｡

所以我会尽量简单｡ 

我将向下滚动, 但如您所见,

在Amazon

S3中您可以对许多不同的事件做出反应｡

然后, 您想要发布到目的地｡ 

所以我们有三个选择｡ 

我们有Lambda函数､ SNS主题和SQS队列｡ 

我将选择SQS队列,

但首先需要创建一个队列, 然后授权Amazon S3将消息发布到该目的地｡

我现在要做的就是进入Amazon

SQS, 然后创建一个队列｡

我称之为“DemoS3Notification”｡  “我将继续创建此队列｡

它被创造出来了｡ 

因此, 现在要做的是增强访问策略,

以允许我的S3桶写入SQS队列｡

因此, 为了做到这一点, 让我首先演示一下这个问题｡ 

因此, 如果我返回此处并刷新此页面,

将显示我的队列｡

所以我刷新它并输入DemoS3Events｡ 

创建所有对象, 然后向下滚动然后选择SQS队列｡

我可以选择ARN队列｡ 

对不起, 我不知道 我可以在下拉菜单DemoS3Notification中选择队列｡

如果我试图保存我的更改,

我会得到一个未知错误, 它说, “嘿,

你不能验证目标配置, 因为这个SQS队列还不接受来自我的S3桶的消息｡

“因此,

我需要更改访问策略, 方法是单击”编辑“,

然后向下滚动, 这是我的访问策略｡

我需要继续制定一个新的策略｡ 

所以我转到策略生成器｡ 

这将是一个SQS队列策略｡ 

其效果是允许任何人, 只是非常宽容,

做一个发送消息｡

而我的亚马逊资源名称就在这里｡ 

我需要复制并粘贴它｡ 

我添加一条语句, 然后生成此策略｡ 

现在, 这是我想要使用的策略,

它允许任何人写入我的SQS队列｡

所以这是非常, 非常宽松的, 但它会工作｡ 

让我们保存这个｡ 

现在我的访问策略已经更新｡ 

现在, 如果我返回此处并尝试保存我的更改,

您可以看到, 操作已成功完成｡

如果我进入SQS队列, 单击“send

and receive messages”（发送和接收消息）,

然后单击“poll for messages”（轮询消息）,

您可以看到, Amazon S3发送了一条消息, 用于测试事件和连接｡

所以我能做的就是把这条消息删除｡ 

因此, 现在我们要测试S3事件通知是否与SQS一起工作｡

因此, 我们将上传一个对象, 单击“添加文件”,

然后选择我们的咖啡, 即JPEG｡

我将上传此文件｡ 

现在文件已上载｡ 

如果我进入我的桶,

我确实可以看到我的咖啡, JPEG, 已经创建｡

想象一下, 我们想自动化这个过程,

并从中创建一个缩略图｡

然后, 我们需要将一条消息放入SQS队列中,

然后对其进行处理并创建缩略图｡

因此, 我将拉取消息｡ 

如您所见, 此处创建了一条消息｡ 

如果你看消息本身, 我会试着增加这个窗口的大小,

我们可以看到“eventName”是“ObjectCreatedPut”, 所以一个对象确实被创建了｡

如果我们看得更深一点,

我们会发现这个信息的关键是咖啡, JPEG｡

因此, 咖啡, JPEG, 被创建,

它生成了一个完整的事件到我的SQS队列｡

因此, 这显示了S3事件通知的强大功能｡

我现在能做的就是删除这条消息,

这样就完成了｡

好吧, 我会的 原来如此｡ 

我们已经看到了S3事件通知｡ 

您需要再次记住的是,

您可以发送到SQS､ SNS和Lambda, 以及将所有事件发送到Amazon EventBridge进行进一步处理并将其发送到更多目的地｡

好吧, 我会的 就这样了｡ 

我们下节课再见｡

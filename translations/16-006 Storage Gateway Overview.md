---
source: 16 - AWS Storage Extras\006 Storage Gateway Overview_zh.srt
---

讲师：AWS开始推动混合云｡ 

什么是混合云？

这意味着您的基础设施的一部分将位于AWS的云上｡

您的基础架构的一部分将保留在内部｡

而这可能是由于多种原因｡ 

也许您有一个长期的云迁移, 也许您有安全性要求或过去的要求,

也许您的战略是只将云用于弹性工作负载, 但将大量内容保留在内部｡

AWS中有一些我们非常喜欢的服务,

它有Amazon S3,

这是一种专有存储技术, 与EFS不同,

EFS是一种NFS合规性文件系统｡

例如, 您将如何公开内部S3数据,

以及此S3和内部基础架构之间的桥梁将是AWS存储网关｡

因此, 如果我们查看AWS上的存储云原生选项,

我们会发现有块存储, 即Amazon

EBS或EC2实例存储｡

我们有Amazon EFS或Amazon FSx等文件系统,

还有Amazon S3或Amazon Glacier等对象级存储｡

现在, 我们来谈谈AWS存储网关｡ 

简单来说, 它是内部数据和云数据之间的桥梁｡

因此, 您拥有内部数据, 并将使用存储网关将其连接到云｡

这看起来很简单,

但我们有不同的使用案例｡

第一个是执行灾难恢复,

将您的内部数据备份到云中｡

或者, 您也可以执行备份和还原,

以便执行云迁移或将存储从内部扩展到云｡

例如, 您的云具有较冷的数据,

而您的内部部署数据具有较热､

更频繁使用的数据｡

此外, 您还可以选择将大部分数据存储在AWS上,

并将存储网关用作本地缓存, 以实现低延迟文件访问｡

因此, 有不同类型的使用情形,

因此也有不同类型的存储网关, 而且数量不多｡

第一个是S3文件网关, 然后是FSx文件网关､

卷网关和磁带网关｡

我会在这节课上解释所有这些｡ 

首先, 我们有Amazon S3文件网关｡ 

因此, 我们有一个S3存储桶,

可以使用任何所需的存储类｡

例如, S3标准､ S3标准-IA､ S3

One Zone-IA､ S3智能分层, 但不包括Glacier｡

我们希望将此S3存储桶连接到内部部署的应用服务器,

但我们希望使用标准网络文件系统｡

为此, 我们将创建一个S3文件网关,

它将允许我们的应用程序服务器使用NFS或SMB协议｡

通过使用此协议, S3文件网关将在后台将这些请求转换为针对Amazon

S3存储桶的HTTPS请求｡

因此, 从应用程序服务器的角度来看,

它看起来像是在访问一个普通的文件共享｡

但实际上, 在幕后它正在使用一个亚马逊S3桶｡

这就是在两个内部部署应用程序服务器上公开S3对象的方式｡

然后, 如果您希望归档其中的一些对象, 则可以为S3存储桶创建生命周期策略,

以便在一段时间后将对象转换到S3 Glacier, 以便归档这些对象｡

因此, 无论您使用S3文件网关配置什么存储桶,

都可以使用NFS和SMB协议进行访问｡

最重要的是, 最近使用的数据缓存在文件网关中,

以便快速访问｡

因此, 不是整个S3存储桶都在文件网关上,

而是最近使用的文件｡

好的, 正如我所说的, 它支持S3存储桶的不同存储类,

您可以使用生命周期策略过渡到S3 Glacier｡

现在, 要访问存储桶,

您需要为每个文件网关创建IAM角色｡

然后, 如果您要使用SMB协议（因为它更适合于Windows文件系统）,

则可以与Active Directory集成以进行用户身份验证｡

因此, 这意味着您的用户可以在访问S3文件网关之前通过S3文件网关进行身份验证,

从而访问您的S3存储桶｡

这就是Amazon S3文件网关｡ 

现在, 我们有了类似的Amazon FSx文件网关,

它再次提供了对Amazon FSx for Windows文件服务器的本机访问｡

因此, 我们在Amazon FSx文件系统上部署了一个Windows文件服务器FSx｡

我们希望从您企业数据中心的SMB客户端进行访问｡

因此, 您知道, 实际上, 如果您使用Amazon

FSx for Windows File Server, 您不需要任何特殊的东西｡

您的内部部署系统已经可以访问此文件夹｡ 

那么, 您为什么要继续创建Amazon

FSx文件网关呢？

如果您创建了网关, 您将获得一个本地缓存,

用于存储频繁访问的数据｡

这意味着, 一些非常重要的文件将缓存在您公司数据中心的本地,

您将能够以低延迟的方式访问它们｡

因此, 这将是您在使用Amazon

FSx Windows文件服务器选项的基础上使用Amazon

FSx文件网关的主要原因｡

您的文件网关还具有Windows和本机兼容性｡

因此, SMB､ TFS和活动目录｡ 

因此, 它对于您希望在内部公开的组文件共享和主目录非常有用｡

接下来是卷网关｡ 

这是使用Amazon

S3支持的iSCSI协议的块存储｡

其理念是通过EBS快照备份您的卷,

从而在需要时帮助您恢复内部部署卷｡

因此, 您有两种类型的卷网关｡ 

您可以使用缓存卷以低延迟方式访问最新数据或存储卷,

其中整个数据集都在本地, 并且有到Amazon

S3的计划备份｡

因此, 这里我们的应用程序服务器需要备份｡ 

因此, 使用此协议, 我们将获得一个卷网关,

卷网关将创建由Amazon

S3支持的Amazon EBS快照｡

这里的逻辑是一样的,

但卷网关的目标实际上是备份内部部署服务器的卷｡

Tape Gateway的优势在于, 如果您的一些公司拥有使用物理磁带的磁带备份系统,

那么使用Tape Gateway,

您可以执行相同的过程, 但磁带将备份到云中｡

因此, 这个虚拟磁带库或VTL将由Amazon

S3和Glacier提供支持｡

您将使用基于磁带的过程和iSCSI接口备份现有数据｡

然后, 这将与领先的备份软件供应商合作｡

所以图中你可以期待｡ 

公司数据中心有一台基于磁带的备份服务器｡

磁带网关将通过将磁带存储到Amazon

S3或Amazon Glacier中来实现与云的接口｡

最后, 正如您在前面的所有图表中所看到的, 网关必须安装在您的企业数据中心上,

它必须在您的企业数据中心内运行｡

但有时您没有虚拟服务器来运行此附加网关｡

因此, 您可以选择利用AWS的硬件｡ 

因此, 它被称为存储网关硬件设备｡ 

因此, 如果您没有内部虚拟化, 您可以使用Storage

Gateway Hardware Appliance,

并且可以在amazon上订购｡ com的网站｡ 

一旦您将此迷你服务器的硬件设备安装到基础架构中,

就可以将其设置为文件网关､ 卷网关或磁带网关｡

这实际上是你必须安装的物理设备,

并将有足够的CPU､ 内存､ 网络和SSD高速缓存资源来正常工作｡

因此, 这非常有用,

例如, 对于没有虚拟化的小型数据中心中的每日NFS备份｡

下面, 我们来总结一下存储网关服务｡ 

因此, 我们有内部部署存储网关虚拟机或硬件设备,

然后是存储网关服务, 最后是AWS云｡

因此, 如果我们希望有一个带有本地缓存的文件网关, 这是一个使用情形,

其中我们有一个用户组文件共享, 并且我们希望通过NFS或SMB协议访问它｡

第一个选项,

我们将其直接连接到S3文件网关｡

因此, 您的数据将由Amazon S3提供支持｡ 

这包括许多存储层, 但Glacier和Glacier Deep

Archive除外｡

但我们可以创建一个生命周期策略,

将其发送到任何存储类Amazon S3, 包括S3

Glacier｡

如果我们使用FSx文件网关, 那么我们会将数据发送到Amazon

FSx for Windows File

Server, 后者会偶尔自动备份到Amazon

S3｡

现在, 卷网关的另一种使用情形是让应用程序服务器通过iSCSI协议装载卷｡

因此, 我们要做的是通过存储网关将此卷网关链接到Amazon

S3｡

这就是您的卷的数据所在的位置｡ 

然后是Amazon S3, 这些数据可以转换为AWS

EBS卷, 以便在AWS上真正恢复｡

接下来, 我们将让您的备份应用程序通过iSCSI

VTL协议连接到磁带网关｡

磁带网关作为磁带库连接到Amazon

S3｡

然后, 我们可以将这些磁带转换到Glacier和Glacier

Deep归档层, 以创建磁带归档｡

希望这总结了我们在这节课上看到的一切,

你们也理解了｡

我希望你们喜欢, 下节课再见｡

```markdown
**学习目标**

- 理解 SNS + SQS 扇出（fan-out）模式的工作方式与优势。
- 掌握订阅策略（过滤）与跨队列分发的实现细节及权限设置要点。

**重点速览**

- 扇出模式：生产者将消息发布到 SNS 主题，主题将消息分发到多个订阅的 SQS 队列或其他端点，实现一条消息多处消费。
- 需要在 SQS 队列的访问策略中允许 SNS 主题写入（跨账户或跨区域时尤其要注意）。

**详细内容**

- 架构与优点：使用 SNS 主题作为中介，多个 SQS 队列作为订阅者，各消费者独立读取各自队列，隔离失败、提高可靠性并便于扩展。适合日志分发、事件广播、跨业务线通知等场景。
- 过滤与 FIFO：
  - SNS 支持订阅过滤策略（JSON 条件），可仅将满足条件的消息路由到特定订阅，减少下游处理负担。
  - SNS FIFO 主题可与 SQS FIFO 队列结合使用，以保证顺序与去重，但吞吐受限且仅允许 FIFO 队列订阅 FIFO 主题。
- 权限与操作：确保为每个订阅的 SQS 队列配置合适的资源策略以允许 SNS 写入；可跨区域/跨账户订阅，但需配置相应策略。

**自测问题**

1. 扇出模式中为什么要为 SQS 队列配置访问策略？
2. 如何用订阅过滤策略只把特定类型的消息路由到某个队列？

```

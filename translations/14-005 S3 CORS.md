## 学习目标

- 理解 CORS（跨源资源共享）概念与浏览器的同源策略限制。
- 掌握浏览器在跨源请求时的预检流程与需要的响应头。
- 会为 S3 静态网站配置 CORS，使跨源页面能正确加载资源（图片、脚本等）。

## 重点速览

- 同源由协议、主机与端口决定；任一不同即跨源。
- 浏览器可能发送预检（OPTIONS）请求，服务器需返回 `Access-Control-Allow-*` 系列头以允许请求。
- 在 S3 上配置 CORS 时可指定允许的 origin、方法、头和预检缓存时间；可允许特定 origin 或 `*`（所有 origin）。

## 详细内容

1. 同源和跨源
- URL 的源包含 scheme（协议）、host（主机）和 port（端口）。如果三者都一致则为同源，反之为跨源。

2. 浏览器工作流程
- 对于跨源请求，浏览器会先发起预检请求（若请求带有复杂头或方法），服务器通过返回 `Access-Control-Allow-Origin`、`Access-Control-Allow-Methods`、`Access-Control-Allow-Headers` 等头来表示允许哪些来源和方法。

3. 在 S3 上配置 CORS
- 若网站托管在一个桶而资源（例如图片）放在另一个桶，目标桶必须设置允许网页来源的 CORS 规则，才能让浏览器成功获取资源。
- 常见配置选项包括允许的来源（精确 origin 或 `*`）、允许的方法（GET、PUT 等）、允许的请求头以及 `Max-Age`（预检缓存时间）。

4. 考试要点
- 能解释为何跨源请求被阻止以及如何通过配置 CORS 解决；熟悉常见的 CORS 头名。

## 自测问题

1. 什么是同源策略？它由哪些部分组成？
2. 浏览器发起预检请求时，服务器需要返回哪些头？
3. 给出一个简单的 S3 CORS 配置，允许 `https://www.example.com` 使用 GET 获取资源。

---
source: 05 - EC2 Fundamentals\013 EC2 Instance Roles Demo_zh.srt
---

老师：好的｡  因此, 让我们练习如何为EC2实例使用IAM角色｡

首先, 我将连接到EC2实例｡ 

您可以使用SSH, 如果需要, 也可以使用EC2实例连接｡

我将使用EC2实例连接,

因为它只是在我的Web浏览器中,

而且更简单｡

回到我的实例, 这里是EC2实例连接｡

我们在我们的实例中｡ 

因此, 如我们所见,

我们是ec2-user@和私有IP｡

因此, 无论您是通过终端使用EC2实例连接或SSH,

还是通过PuTTY使用其他工具｡

如果你看到这个, 我们就在同一个阶段, 好吗？

现在您可以执行一些Linux命令｡ 

例如, ping谷歌,

你可以从谷歌那里得到一些信息｡

我将使用Control + C退出它,

或者发出任何您想要的Linux命令｡

好的, 你不需要知道下一个进入考试的命令,

但这只是一个Linux终端, 你现在可以在云中使用｡

因此, 我们将键入clear以清除屏幕,

接下来我们必须运行一些IAM命令｡

最酷的是, 我们现在使用的Amazon

Linux AMI附带了一个CLI｡

如您所见, 它已经安装好了

所以我们能做的就是开始使用一些命令｡ 

例如, aws iam列出用户｡ 

如果我们这样做, 它说无法查看凭据｡ 

您可以使用aws configure配置凭据｡ 

因此, 我们确实可以运行aws configure来配置凭据,

并指定访问ID､ 秘密访问密钥和区域名称｡

但这真的是个非常非常糟糕的主意｡ 

原因是, 如果我们运行aws configure并在此EC2实例上输入我们的个人详细信息,

那么我们帐户中的任何其他人都可以再次连接到我们的EC2实例｡

例如, 使用EC2实例连接并在我们的实例中检索这些凭据的值,

这不是我们想要的｡

这是非常非常糟糕的事情｡ 

因此, 作为一个经验法则, 永远, 永远, 永远不要输入您的IAM

APA键｡

因此Access Key ID和Secret Access密钥进入一个EC2实例｡

这是可怕的, 如果你看到有人这样做,

请给他们看这个视频｡

相反, 我们必须使用IAM规则｡ 

如果您还记得, 当我们在管理控制台和IAM中时,

我们创建了一个IAM角色｡

现在, 让我们回到角色｡ 

我们有一个EC2的演示角色, 它附加了一个名为IAMReadOnlyAccess的策略｡

因此, 我们将把这个角色附加到EC2实例上,

以便为它提供凭据｡

好吧, 那我们该怎么做？

为此, 我们可以进入“安全”｡ 

正如您所看到的,

我们的实例上现在没有IAM角色｡

因此, 我们可以做的是返回到“实例”､

“操作”､ “安全性”, 然后选择“修改IAM”角色｡

在这里, 我们必须选择IAM角色｡ 

因此, 我们有DemoRoleForEC2, 并单击“保存”将此IAM角色附加到我们的实例中｡

因此, 如果您返回到“安全性”,

现在IAM角色已附加到实例DemoRoleForEC2｡

因此, 这样做的效果是, 如果我们现在执行aws

iam列出用户并按Enter键, 我们将从IAM获得有关用户的响应｡

因此, 正如我们所看到的, 我们没有运行命令aws configure｡ 

我们只是附加了一个IAM角色并运行了此命令｡ 

而且很管用｡ 

作为证明, 如果我们进入这个角色并分离这个权限,

现在它消失了, 再次运行命令, 我们将得到一个访问被拒绝｡

因此, 角色现在实际上链接到EC2实例｡ 

这就是我们仅通过IAM角色向EC2实例提供AWS凭据的方式,

明白吗？

因此, 如果我们返回IAM, 将策略附加到此角色,

然后返回IAMReadOnlyAccess, 附加此策略,

然后重新运行命令, 我们会得到访问被拒绝, 因为有时需要一点时间将更改从IAM传播到AWS｡

但是如果我们再运行一次, 我们就会得到我们期望的输出,

这就是我们想要的｡

因此, 了解这一点非常重要,

请为EC2实例使用IAM角色｡

所以希望这对你有好处｡ 

我希望你们喜欢这个实践,

我们下节课再见｡

---
source: 08 - High Availability and Scalability ELB & ASG\014 Elastic Load Balancer - Connection Draining_zh.srt
---

教师：现在我们来讨论一个可能会在考试中出现的功能,

称为"连接清空“｡

实际上, 它有两个名字｡ 

如果您使用的是传统负载平衡器,

则称为“连接耗尽”,

但如果您使用的是应用程序平衡器或网络负载平衡器,

则称为“注销延迟”｡

这个概念背后的想法是,

在实例被注销或标记为不正常时,

它将为您的实例提供一些时间来完成正在进行的请求或活动的请求｡

一旦连接被清空, 也就是说一旦实例被清空,

ELB将停止向注销时被清空的EC2实例发送请求｡

让我们看一下图表, 以便更好地理解｡ 

因此, 我们有三个EC2实例, 其中一个实例将设置为清空模式｡

因此, 已经连接到EC2实例的用户将有足够的时间（即耗尽期）来完成其现有连接和现有请求｡

然后一旦一切都完成了,

那么所有的连接将被关闭｡

现在, 如果新用户尝试连接到我们的ELB,

我们的ELB足够智能,

能够知道因为我们的EC2实例处于耗尽状态,

所以它将只与其他EC2实例建立新连接,

例如, 我的第二个EC2实例或我的第三个EC2实例｡

现在, 您可以参数化这些“连接排出”参数｡

因此, 您可以将其设置为1到3, 600秒之间的任意值｡ 

默认情况下, 它是300秒, 也就是5分钟,

如果将值设置为零, 则可以完全禁用它, 这意味着不会发生排水｡

现在, 如果您将其设置为低值, 那么, 如果您的请求很短,

这是很好的选择, 例如, 如果有非常非常短的请求,

比如说, 不到一秒, 那么, 将dailing connection参数设置为30秒是一个好主意, 因为这样可以非常快地清空EC2实例, 然后使其脱机｡

也许是要被替换或者类似的事情｡

如果您的请求可能很长,

例如, 如果您有上传或长期请求,

那么您需要将其设置为相当高的值,

但代价是EC2实例不会尽快消失, 它必须等到连接耗尽期结束后才能消失｡

因此, 这是您需要了解的有关此设置的高级信息｡

我希望你们喜欢它, 我们下节课再见｡

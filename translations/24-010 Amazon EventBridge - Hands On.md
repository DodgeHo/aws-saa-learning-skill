---
source: 24 - AWS Monitoring & Audit CloudWatch, CloudTrail & Config\010 Amazon EventBridge - Hands On_zh.srt
---

讲师：好的, 首先让我向您展示CloudWatch

Events UI｡

这就是CloudWatch Events,

在CloudWatch中,

有一些Events, 它会在某个时候消失,

所以如果你找不到它, 不要感到惊讶, 因为现在的CloudWatch

Events是EventBridge, 它是CloudWatch

Events的增强版｡

因此, 我可以进入Amazon EventBridge并查看新的UI｡ 

所以在这里我可以接触到很多东西｡ 

因此, 在事件总线下, 我们可以访问默认的事件总线｡

这个事件总线是在您的帐户中默认创建的｡

您已经可以开始定义它的规则｡ 

但是你可以创建你自己的事件总线,

把这个称为中央事件总线, 我正在重新创建,

所以V2｡

如果需要, 您可以启用事件归档,

归档这些事件并永久保留它们,

以便在需要执行某些调试以及自动模式发现时使用｡

如果您需要在此事件总线上获得跨帐户访问权限,

则可以定义基于资源的策略,

模板将在此处提供｡

为此, 您需要编辑所有内容｡ 

因此, 如果您没有基于资源的策略, 那么只有事件总线所有者可以向事件总线发送事件,

这对我们来说很好｡

因此, 让我们创建它,

您已经创建了一个自定义事件总线, 现在我们可以开始了｡

那么现在我们来谈谈事件｡ 

因此, 我们有来自合作伙伴的事件源｡ 

例如, 在这里, 我们可以说我想要捕获来自Auth0的所有事件｡

因此, 我们将设置,

下面是为Auth0设置事件总线的方法｡

因此, Auth0网站上有一些说明可供阅读｡

一旦一切都设置好了, 我就可以直接在EventBridge中捕获Auth0中的事件｡

现在, 所有事件都已捕获到EventBridge中,

您需要继续创建一些规则｡

因此, 您需要选择“创建规则”选项, 我将其命名为DemoRuleEventBridge｡

然后我们选择总线｡ 

所以总线可以是默认的, 也可以是中央总线, 或者你想创建的任何东西,

对吗？

我将使用默认总线,

因为它是默认创建的总线｡

你可以按计划进行｡ 

例如, 我说：“嘿, 我希望这个规则每小时运行一次｡

“这可能是一种在云中执行cron的方法,

或者我希望在发生此特定事件时运行此规则｡

所以让我们选择第一个｡ 

接下来, 我们必须选择一个事件源｡ 

我们有几个选择｡ 

我们要么希望事件源来自AWS,

因此选择AWS服务, 要么这是一个自定义事件或合作伙伴事件,

我们将选择“其他”｡

如果您希望跨帐户集中管理帐户中的所有事件,

则可以选择“All events”（所有事件）,

然后通过基于资源的策略将其发送到中央事件总线｡

但现在, 我们将选择AWS服务,

接下来我们可以过滤示例事件｡

这是一项新功能, 称为Sandbox｡

因此, 如果您返回到Amazon EventBridge并转到此处的Sandbox,

您实际上可以使用示例事件进行测试, 然后在不创建规则的情况下针对事件模式进行测试｡

但是, 在创建规则时也可以访问这些UI｡

对于示例事件, 我将选择EC2｡ 

不要被愚弄了, 这里有自动缩放功能,

但向下滚动, 现在是EC2｡

您将转到EC2状态更改通知｡

每当有状态更改通知时,

就会将这种事件发送到EventBridge中｡

因此我们可以选择不同的样本事件｡ 

正如您所看到的,

这一个, 即时状态是挂起的,

而这一个是运行的, 好吗？

因此, 让我们假设我们希望在实例进入V时生成事件｡

让我们选择停止状态, 因为我们想知道它们何时被停止｡

好了, 停下来, 我们走｡ 

我将向下滚动并创建一个事件模式｡

因此, 我将选择EC2作为服务提供者,

并选择实例状态更改通知作为事件类型｡

我们可以有所有的状态,

如果我测试一下, 现在的模式会和样本事件匹配｡

但我可以指定一个特定的状态｡ 

例如, 仅限于已停止或终止的实例｡

正如您所看到的, 我的事件模式变得更加精细｡ 

所以如果我们现在测试它,

它将与上面的结果相匹配, 这很好｡

但是如果我选择挂起或运行状态,

并再次测试模式, 它不会被剪切｡

因此, 我们可以肯定,

我们现在捕获的事件是在EC2实例停止或终止时发生的｡

我们为什么要这样做？

好吧, 也许是因为无论何时发生这种事,

我们都想得到通知｡

因此, 目标可以是EventBridge事件总线（当您希望集中目标时）或API目标,

或者您可以选择以下AWS服务之一｡

你可以看到,

你有很多可能的目标或行动｡

但我感兴趣的是SNS主题, 因为我想在演示主题中发送一条消息,

说明EC2实例何时停止或终止｡

我将依次单击“Next”､ “Next”, 然后单击“Review”和“Create”｡ 

是的, 我的规则看起来不错｡ 

让我们创建此规则｡ 

现在, 您可以尝试启动EC2实例,

然后终止或停止它, 并确保您通过电子邮件订阅了SNS主题, 然后,

每当实例停止或终止时, 您都会收到电子邮件, 我认为这非常好｡

总之, 如果需要, 我们还提供了用于查找所有事件存档的存档,

以及用于重放事件并将其放回事件总线以正确修复集成的重放｡

最后是模式注册表｡ 

所以这是一种观察这些事件的模式的方法｡

例如, 我们可以查看AWS事件模式注册表,

然后输入aws｡

ec2,

在这里, 您可以查看AWS EC2, 即EC2的即时状态更改通知｡

所以它是第一版, 模式类型是OpenAPI 3｡  0, 这就是架构本身｡

这意味着它定义了,

这些事件的可能性｡

所以我们可以看到, ID是一个字符串,

源是一个字符串, 时间是一个日期-时间格式的字符串,

等等｡

这定义了事件本身的外观｡

多亏了这个模式, 它非常复杂, 你可以下载代码绑定,

它会为你生成代码, 例如, 用Java,

Python, TypeScript或Go语言, 这样你就可以在你的代码中以一种更容易的方式操作这些对象, 而不需要为你写一些手动代码｡

好了, EventBridge就到这里｡ 

正如您所看到的, 这是一个非常完整的服务,

具有许多不同的特性,

但最重要的特性是设置规则和使用资源策略设置事件总线｡

好吧, 就这样｡ 

我希望你们喜欢, 下节课再见｡

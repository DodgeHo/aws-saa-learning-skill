---
source: 14 - Amazon S3 Security\008 S3 MFA Delete Hands On_zh.srt
---

教师：好的, 我们来演示一下MFA删除｡ 

我将创建一个桶, 并将其命名为demo

stephane MFA delete 2020（eu-west-1）｡

我将启用存储桶版本控制, 然后单击“创建存储桶”｡

好的, 很好｡ 

现在, 如果我们转到此存储桶（MFA存储桶）,

然后转到“属性”和“存储桶版本控制”, 然后单击“编辑”｡

正如您所看到的, 多因素身份验证（MFA）删除当前被禁用,

并且由于某些原因, 您无法通过Amazon控制台的UI更改此设置｡

所以也许有一天他们会允许我们启用它｡ 

但现在,

您需要做的是使用AWS

CLI直接启用它｡

因此, 本上机操作的先决条件是确保在IAM下,

您已经为root帐户设置了MFA设备｡

我现在使用的是root帐户,

如您所见, 我以root身份登录｡

我需要做的就是点击它, 然后点击我的安全凭据｡

这将转到IAM中的安全凭据｡ 

在多因素身份验证MFS下,

您可以看到我已经为MFA设置了一个虚拟设备,

ARN就在这里｡

好吧, 这是好事｡ 

接下来, 我们必须实际配置ADA CLA以使用此root帐户｡

现在, 我不建议这样做, 除了在您的S3存储桶上启用MFA删除｡

因此, 我将创建新的访问密钥,

并下载密钥文件, 然后显示访问密钥｡

我会删除它们, 所以不要担心看到我的,

但你永远不应该与任何人共享你的根访问密钥以及你的秘密访问密钥｡

现在我需要你们用这两个小设置来设置CLA｡

我将配置命令行｡ 

AWS进行配置, 然后我将创建一个配置文件, 我将此配置文件命名为roots-MFA-delete-demo｡

您可以在s3advanced下找到此文件｡

mfadelete（删除） 嘘

所以我们用的是他们的评论｡ 

我将设置此配置文件, 然后在您输入我的访问密钥ID后,

该ID就在此处｡

我们来粘贴这个, 我的秘密访问密钥,

就在这里, 粘贴它｡

默认区域名, eu-west-1, 我们可以开始了｡ 

现在, 如果我使用AWS S3 LS, 它是否有效？

并使用我刚刚创建的配置文件来执行此操作, 顺便说一下,

该配置文件名为root-MFA-delete-demo｡

是的, 这给了我三个水桶｡ 

所以我的个人资料设置正确｡ 

接下来, 我需要做的是启用MFA删除｡ 

因此, 这里有一个完整的设置,

我将复制它, 然后与您一起编辑｡

因此, 我粘贴它, 我需要首先更改存储桶名称｡ 

现在这个桶叫做, MFA-demo-stephane, 但我会把它改成demo-stephane-MFA-delete-2020,

这很好｡

版本控制配置状态已启用｡ 

MFA删除等于启用｡ 

我们可以转到这里, 然后我们需要指定MFA设备的ARN,

我可以找到它｡

所以让我们找到它就在这里｡ 

这是MFA设备的ARN,

我把它贴上去.

最后是MFA代码｡ 

我将直接从我的应用程序中获取这些信息, 它将提供我的MFA代码｡

710343, 请按回车键.

显然这是不正确的｡ 

那我们再等一次吧｡ 

我们可以开始了

好吧, 这是被陷害的

那么现在我们怎么知道它是否有效呢？

如果我进入存储桶版本控制并进行刷新, 正如我们现在看到的,

存储桶版本控制显示已启用存储桶版本控制以及多因子身份验证, MFA删除也已启用｡

那么, 我们怎么知道它是否有效呢？

好吧, 假设我要访问我的对象, 然后我要上传对象｡

比如说, 我上传一个JPEG文件的副本,

我会上传它, 这样就可以了｡

现在如果我回到我的桶,

把这些对象删除｡

好的, 我们要删除它, 但我们已经启用了版本控制,

所以这只是要添加一个删除标记｡

这也很有效｡ 

所以总而言之到目前为止, 一切都很好｡ 

如果我现在列出我的bucket版本,

我的文件有两个版本, 但是现在,

如果我想, 例如, 删除这个特定的版本ID｡

好吧, 这个叫做永久删除｡ 

它指出, 您无法删除对象,

因为此存储段启用了多因子身份验证和MFA删除｡

为此, 我们需要使用CLI命令删除此文件或禁用MFA删除｡

因此, 我们可以继续禁用MFA删除,

为此, 命令就在这里｡

因此, 这一次执行MFA delete

equals disabled的命令是相同的｡

我将从前面的命令中删除它,

开始吧.

MFA删除等于禁用, 显然我需要更改MFA代码｡

因此, 让我等待下一个MFA代码出现在我的屏幕上｡ 

希望它能起作用｡ 

按回车键｡ 

好了, 这就行了｡ 

现在如果我尝试另一次删除, 例如, 删除,

删除标记｡

是的, 它正在工作, 因为我已经禁用了MFA删除｡ 

所以我们输入这些信息来确认一下｡ 

最后, 返回到存储桶, 进入属性,

在存储桶版本控制下, 可以看到MFA删除已禁用｡

这节课就讲到这里｡ 

希望你喜欢｡ 

很明显, 在讲座的最后, 我差点忘了, 但不,

我没有忘记｡

请删除您的路线访问密钥｡ 

这对你来说真的很糟糕,

所以, 我会停用它们, 我们就可以走了, 然后最后我可能会在某个时候删除它们｡

好吧, 就是这样｡ 

非常感谢, 下节课再见｡

---
source: 22 - Data & Analytics\003 Redshift_zh.srt
---

讲师：现在我们来谈谈Amazon Redshift,

它既是一个数据库, 也是一个分析引擎｡

Redshift基于PostgreSQL技术, 但不是PostgreSQL,

它不用于在线事务处理｡

它实际上是一个全应用类型的数据库,

这意味着在线分析处理, 它用于分析和数据仓库｡

因此, 它的性能比任何其他数据仓库都高出10倍,

并且可以扩展到PB和PB级的数据｡

所以这个想法是, 你将所有的数据加载到Redshift中,

然后很快你就可以从Redshift中随机化它｡

所以Redshift有很好的性能改进,

因为它实际上使用了数据的列存储, 而不是基于行的,

而且它有一个并行查询引擎｡

您可以为Redshift集群中提供的所有实例付费,

并执行查询, 您可以直接使用一些SQL语句｡

因此, 任何商业智能工具, 如Amazon QuickSight或其他工具,

如Tableau, 都可以与Redshift集成｡

所以如果你要比较红移和雅典娜,

首先你要加载数据｡

有时从亚马逊服务器, 你必须加载所有的数据到Redshift,

然后Redshift说, 是的, 好吧, 如果它加载在Redshift, Redshift将有更快的查询｡

此外, Redshift可以做更快的连接和更快的集成,

因为Redshift实际上有一些Athena没有的东西｡

Redshift有索引, 它为数据仓库构建索引以获得非常高的性能｡

因此, 如果它只是Amazon S3上的一个临时查询,

那么Athena将是一个很好的用例,

但是如果它像是具有许多查询的密集数据仓库,

并且它们很复杂, 有连接, 聚合等, 那么Redshift将是一个更好的候选者｡

所以你的红移星团有两样东西｡ 

它有领导者节点, 他们做查询规划和结果汇总,

然后它有计算节点, 他们实际执行查询,

并将结果发送回领导者｡

由于它是一个Redshift集群,

因此必须提前配置节点大小｡

如果你想节省成本, 你可以使用保留实例｡

所以你的Redshift集群有一个leader节点,

然后是一些计算节点, 然后你会在SQL表单中向leader节点提交一个查询, 查询将在后端发生｡

这就是关于红移的概述｡ 

让我们谈谈快照和DR｡ 

因此, 对于大多数星系团来说, 红移是单AZ模式,

但现在对于某些星系团类型来说, 有一种多AZ模式｡

因此, 如果您有多个可用区,

那么您可以进行灾难恢复, 但如果您有单个可用区,

那么要进行灾难恢复, 您需要使用快照｡

快照是群集的时间点备份, 它们将存储在Amazon

S3内部, 并且仅为增量备份｡

已经改变的内容将被保存, 这将为您节省很多空间,

很明显｡

您可以将快照恢复到新的Redshift集群中,

快照有两种模式｡

你可以手动操作, 也可以自动操作｡

因此, 如果自动化,

每八小时将是一个快照,

或每五GB的时间表｡

然后, 您可以设置自动快照的保留期｡

或者, 如果您想手动创建快照,

快照将一直保留, 直到您手动删除它｡

然后, Redshift的一个非常非常酷的功能是,

您可以配置Redshift以自动复制快照,

无论它们是自动还是手动将群集复制到另一个AWS区域, 从而为您提供灾难恢复策略｡

让我们拿这个红移星团, 你原来的星团, 然后我们有另一个区域｡

所以我们要拍快照｡ 

它们将被自动复制到您的新区域中,

然后您可以从复制的快照中恢复新的Redshift集群｡

现在让我们来谈谈如何将数据摄取到Redshift中｡ 

所以我有三种方法来描述｡ 

第一个是使用Amazon Kinesis Data Firehose｡ 

所以我们有Firehose, 它将从不同的来源接收数据,

然后将其发送到Redshift｡

为此, 它将首先将数据写入Amazon

S3存储桶, 然后Kinesis Data Firehose将自动发出S3复制命令以将数据加载到Redshift｡

这个复制命令是如何工作的呢？

我们也可以手动使用它｡ 

因此, 您可以将数据加载到S3中, 然后直接从Redshift发出复制命令,

使用IAM角色将S3存储桶中的数据复制到Amazon

Redshift群集中｡

正如我们所看到的, 有两种方法可以做到这一点｡ 

你可能会通过互联网, 因为你的S3桶是通过互联网公开的｡

我的意思是,

它们不是公共的, 但它们连接到互联网,

因此, 您将通过互联网检查您的数据流回到您的Redshift集群, 这是没有增强的VPC路由,

但如果您希望所有网络都保持私有到您的虚拟私有云, 那么您可以启用VPC路由, 使所有数据流完全通过VPC｡

最后, 如果您想使用JDPC驱动程序将数据插入Redshift集群,

也可以这样做｡

例如, 如果您有一个应用程序和EC2实例需要将数据写入Redshift集群,

则需要使用此方法｡

在这种情况下, 最好是将大量数据写入Amazon

Redshift, 而不是一次一行, 这对于这种类型的数据库来说确实效率低下｡

红移的一个很酷的特性就是红移光谱｡ 

您将在Amazon S3中拥有数据, 并且您希望使用Redshift对其进行分析,

但您不希望首先将其加载到Redshift中,

并且在此之上,

您希望使用更多的处理能力, 因此您使用Redshift

Spectrum, 并且您必须已经有一个Redshift集群可以启动查询, 然后一旦你开始查询,

查询将被提交给Redshift的数千个频谱节点, 这些节点将在S3中对你的数据执行查询｡

让我们举个例子｡ 

您有一个Redshift集群, 其中包含一个leader节点和一堆计算节点,

您想要分析的数据位于Amazon S3中｡

在本例中, 您将对我们的Redshift集群运行一个查询｡

正如我们所看到的, 我们想要做的是,

我们想要查询的表存在于S3中｡

我们从S3开始｡  你想要什么都行

在这种情况下, Spectrum将自动启动,

因此查询将被提交给数千个Redshift

Spectrum节点, 这些节点将从Amazon

S3读取数据并执行一些聚合｡

当他们完成后, 他们会将结果发送回您自己的Amazon

Redshift集群, 然后您将返回到发起查询的人｡

但是有了这个功能,

我们可以利用Redshift的处理能力,

而不是我们在集群中提供的处理能力,

而不必首先从Amazon加载数据｡

这就是Amazon Redshift｡ 

希望你们喜欢, 下次课再见｡

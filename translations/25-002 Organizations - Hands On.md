---
source: 25 - Identity and Access Management (IAM) - Advanced\002 Organizations - Hands On_zh.srt
---

旁白：好的｡  所以我们要练习使用组织｡

为此, 我将进入组织服务并开始｡

正如我们在本例中所看到的, Organizations是一项全局服务,

因为它与帐户有关, 并将它们重新分组在一起,

明白吗？

我做的另一件事是我为此创建了自己的新帐户｡

因此, 我创建了AWS课程主帐户,

在另一个窗口中, 我有AWS课程子帐户, 因为我不想使用我的主帐户,

我想用两个单独的帐户做一个演示｡

所以如果你想跟着我我建议你创建两个新帐户｡

您可以根据需要调用它们, 以便在您的组织中拥有一个主帐户和一个子帐户｡

因此, 我将从主帐户开始创建一个组织｡

现在, 在组织内部, 我们必须定义其中的帐户｡

正如我们现在所看到的,

这是非常快的, 组织已经创建,

我们有了根组织单位｡

在其中, 我们有AWS课程主账户,

即主账户,

也称为管理账户, 好吗？

所以我们要这么做｡ 

组织也就创建了｡ 

现在, 我们要将第二个AWS作为帐户添加到此组织中｡

为此, 我将添加一个帐户｡ 

我们有两种选择,

一种是创建一个帐户,

然后您指定帐户名称､ 帐户所有者的电子邮件地址以及IAM角色, 该角色将在目标帐户中创建,

以便允许组织进行管理｡

您也可以邀请现有的AWS帐户, 在这种情况下,

您需要提供与该帐户关联的电子邮件地址或要邀请的帐户的帐户ID｡

而对于这个, 我只会做我的帐户的名称｡ 

所以我只想添加电子邮件, 这是aws-child-account@stephanemaarek｡

com的网站｡ 

这是好去｡ 

我们可以包括消息, 如果你想和添加一些标签,

但我会继续前进, 并发送我的邀请｡

现在, 我的邀请已发送到我的其他帐户, 我们可以通过此UI查看所有待定邀请,

而且邀请尚未过期, 因此, 如果两周后邀请未被接受, 则此邀请将过期｡

所以接下来我能做的就是用我的孩子账户去我的组织｡

左手边是“邀请函”｡ 

所以我点击了“邀请”｡ 

我将刷新此页面｡ 

现在我们看到我从主帐户发出的邀请｡ 

因此, 正如我们现在在该组织中看到的,

我们将获得完全控制权, 因为该组织已启用全部功能, 可以完全控制您的帐户｡

因此, 一旦你成为一个组织的一部分,

你就接受了这个组织的主人的控制｡

所以我们接受邀请｡ 

我们开始吧｡ 

现在, 我的帐户（即子帐户）已注册到我的AWS组织中,

我们只能看到组织ID和功能集｡

并且帐户可能具有离开组织的能力｡

所以回到我的AWS组织｡ 

现在, 如果我转到我的帐户, 我会单击AWS帐户｡ 

正如我们现在看到的, 在我的组织中,

我们有根, 在根中, 我们现在有两个帐户,

主帐户和子帐户｡

因此, 我们现在可以使用组织单位（OU）来组织客户｡

因此, 我们只需执行操作, 然后创建一个新OU｡

所以我们要从根部开始, 好吗？

操作会创建新的OU, 我可以有一个OU, 例如, 用于我的开发人员帐户｡

然后创建OU｡ 

我也可以在这里创建OU, 这次我会说测试,

也许用更少的时间我们就会有一个产品,

所以我只会做一个prod OU.

也许在生产OU中, 我们有不同的部门｡ 

因此, 我可以再次在OU中创建OU｡ 

因此, 如果我们的人力资源部门拥有生产应用程序,

或者我们的财务部门拥有分析应用程序,

那么我就可以拥有人力资源部门｡

因此, 正如您在这里看到的,

您可以创建任意多个嵌套OU｡

如果您一直转到您的组织, 然后查看OU, 现在我们可以看到,

我们有root､ dev, 现在,

dev､ prod中没有帐户, 而prod中有finance和HR,

然后是test｡

因此, 正如我们所看到的, 我们可以开始组织客户,

我们在特定OU内的组织中有许多客户｡

我们这样做的原因是要有服务控制策略｡ 

因此, 我们首先要做的是将我们的子帐户转移到prodd内的财务部门｡

因此, 我可以使用此帐户, 然后我可以说移动, 然后我可以在我的prod

OU中将其导入我的财务部门｡

所以我把账户移到了那里｡ 

现在, 如果我们查看一下, 我们可以看到财务部门包含课程子项｡

最好的做法是将管理帐户保留在根OU下,

但如果您愿意, 也可以移动它｡

好吧, 我会的 因此, 现在我们希望启用服务控制策略来限制我的课程子帐户可以执行的操作｡

为此, 我们进入“策略”, 可以看到,

我们现在有四种不同的策略可用,

它们当前处于禁用状态｡

因此, 我们所能做的就是采用我们需要的重要策略类型并启用它们｡

因此, 我们肯定要启用服务控制策略,

因为这将允许您限制我们的子帐户可以做什么｡

因此, 这是启用的, 我返回到“策略”｡ 

我们还有其他可能感兴趣的策略,

例如, 备份策略允许您部署组织范围的备份计划, 以确保您的所有帐户都合规并启用了备份, 或者标记策略也有助于标准化您在组织中所有不同帐户内使用标记的方式｡

但是, 为了进行实际操作,

并从考试的角度来看,

我认为将只使用服务控制策略, 但仍然很高兴知道,

您可以在所有帐户上应用备份策略, 也可以在所有帐户上应用标记策略｡

好吧, 我会的 因此启用了服务控制策略｡ 

因此, 现在我们要做的是定义服务控制策略｡

我将单击“服务控制策略”,

这是文档, 对不起｡

这里我们有一个到目前为止已创建的服务控制策略,

即完全AWS访问｡

好吗？ 而完整的AWS访问权限允许所有帐户访问所有服务｡

但我们可以创建一个新策略并附加它｡ 

因此, 我们可以创建一个名为“哎呀”的策略-我们可以创建一个名为“拒绝访问S3”的策略,

这将拒绝其所连接的任何OU或帐户访问S3服务｡

所以在政策方面, 我们可以找到一个声明｡ 

例如, 我们可以在这里找到S3服务,

在S3中, 我们可以说所有操作和资源也将是star｡

所以我会在这里放一颗星星｡ 

所以我们被拒绝了, 这是一个非常简单的策略,

我称之为拒绝S3作为Sid｡

然后单击“Create policy”（创建策略）｡ 

所以, 当这个连接到我的帐户时,

应该会拒绝访问S3｡

这样我们就可以看看了｡ 

我们来看看我们的账户｡ 

好吧, 我会的 如果我们查看根目录并单击“root”,

我们可以看到, 已启用的策略类型是服务控制策略｡

如果我单击Policies（策略）,

则会有一个应用的策略直接附加到根OU,

这是对AWS的完全访问权限, 它允许根及其所有子级上的所有内容访问AWS中的所有服务｡

因此, 如果您查看根OU的子OU,

我们会看到例如prod OU｡

如果我们看一下prodOU,

就策略而言, 有两个策略, 一个是直接附加的,

即完全AWS访问, 另一个是从根继承的,

即完全AWS访问｡

所以它出于某种原因复制了这个｡ 

然后如果我进入金融领域的儿童领域,

点击保单, 我们会看到三个附加保单｡

所以一个从prod继承, 一个从root继承,

一个直接连接｡

这可能是因为我在创建OU后启用了服务控制策略｡

所以这个完整的AWS访问权限被附加到我账户中的每一个元素上｡

如果我们查看产品OU中财务OU课程的子级,

单击课程本身､ 帐户本身, 然后转到策略,

现在我们有四个子级｡

所以我们有四次完整的AWS访问权限｡ 

所以你至少理解了继承的概念,

这是有道理的｡

你可以从根那里继承一些明确的东西｡ 

你继承了最顶层的东西, 但我们能做的是,

如果我们回到上一层｡

例如, 如果我们转到我的prod和finance OU, 我们可以附加一个新策略｡

因此, 我将附加一个新策略,

该策略将是DenyAccessS3｡

我将附上它,

现在这意味着我的财务OU内的任何东西也应该有这个继承｡

如果我单击我的课程子项, 然后单击策略,

我们可以看到DenyAccessS3是从财务继承来的｡

那么我们如何确保这是工作？

好吧, 如果我现在去我的帐户我的孩子帐户,

并打开S3控制台在一个新的选项卡｡

我们在S3中, 正在加载bucket, 但正如我们所看到的,

我们没有列出bucket的权限,

因此我们不能使用Amazon S3｡

这是由于我们已附加到OU的策略｡ 

它的功能非常强大, 因为我们能够限制帐户的整体功能,

即使我现在使用我的root用户登录,

我仍然无法访问Amazon S3｡

这是非常强大的, 这就是STP的工作原理｡ 

希望这对你有意义｡ 

所以, 这是这个动手｡ 

希望你喜欢｡ 

我们下节课再见｡

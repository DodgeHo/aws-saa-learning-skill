---
source: 19 - Serverless Overviews from a Solution Architect Perspective\016 Amazon Cognito Overview_zh.srt
---

讲师：现在我们来谈谈亚马逊Cognito｡ 

它的目标是给用户一个身份来与Web和移动应用程序交互｡

因此, 这些用户通常不在我们的AWS账户之内, 因此我们将其命名为Cognito,

因为它为用户提供了一个我们还不知道的身份｡

因此, 我们在Cognito中有两种子服务｡ 

我们有Cognito用户池,

它为应用程序用户提供了登录功能,

并与API网关和应用程序负载平衡器进行了很好的集成｡

我们有Cognito身份池,

以前称为联合身份｡

这实际上是为注册了应用程序的用户提供临时AWS凭据,

以便他们可以直接访问AWS的一些资源｡

我们将在Cognito

User Pools中看到很好的集成｡

因此, 如果您问自己：“难道IAM中没有用户吗？

“答案是肯定的,

你需要, 但Cognito将是为你的Web和移动应用程序用户, 它位于AWS之外｡

因此, 请查找关键字,

如数百个用户､ 移动用户或使用SAML等机制进行身份验证等｡

让我们深入了解一下Cognito用户池或CUP｡ 

因此, 它是一个用于Web和移动应用程序的无服务器用户数据库｡

您还可以定义一个简单的登录名,

例如用户名或电子邮件和密码的组合｡

您具有密码重置功能｡ 

您可以进行电子邮件和电话号码验证,

对用户进行多因素身份验证,

还可以与例如Facebook或Google等进行集成以进行登录,

等等｡

因此, Cognito用户池与API网关或应用负载均衡器集成｡

以API网关为例, 用户将连接到Cognito用户池,

检索令牌, 将该令牌传递给API网关,

API网关将对其进行验证, 如果验证结果正确, 则将其转换为用户身份,

然后将其传递给作为后端的lambda函数｡

现在你的lambda函数知道了它要处理的用户,

以及它有一个非常特定的用户, 这个用户已经过了很好的身份验证｡

或者, 您也可以在应用程序负载均衡器上对Cognito用户池执行完全相同的操作｡

因此, 这意味着您的应用程序将再次与Cognito用户池连接,

然后将其传递给您的应用程序负载均衡器,

并确保存在真正的登录｡

如果是真的,

它会将请求重定向到后端,

并传递一些带有用户身份的附加头｡

因此, 这真的允许您在一个地方拥有API网关或ALB,

确保您可以验证用户的登录｡

因此, 您的责任已经从后端转移到了实际部分,

它将平衡后端的负载｡

因此, API网关或ALB｡ 

好的, Cognito的另一个子部分是Cognito身份池或联合身份｡

这是为了获取用户的身份, 但这一次,

他们不会通过API网关或应用负载平衡器访问我们的应用,

而是使用临时AWS凭据直接访问您的AWS帐户｡

因此, 用户的来源可以是Cognito用户池中的用户,

也可以是第三方登录, 然后他们可以直接或通过API网关访问AWS的服务｡

因此, 应用于凭据的IAM策略已经在Cognito

Identity Pool服务中定义｡

并且可以根据用户ID进行自定义,

以实现细粒度控制｡

如果您希望拥有默认的IAM角色, 则可以这样做, 以便没有为其定义特定角色的来宾用户或经过身份验证的用户将继承此定义的IAM角色｡

因此, 图表肯定会帮助您了解什么是身份池｡

因此, 假设您的Web和移动应用程序希望直接访问S3桶或DynamoDB表｡

因此, 我们将为此使用Cognito身份池｡ 

因此, Web和移动应用程序将登录并从中获取令牌｡

因此, 它可能是针对Cognito用户池､

社交身份提供商､ SAML或开放ID连接等的登录｡

然后, 它将获取此令牌,

并将其传递给Cognito身份池服务,

以将此令牌交换为临时AWS凭据｡

为此, Cognito身份池首先要评估传递的令牌是否正确,

即登录是否有效｡

它要做的第二件事是制定特定于该用户的IAM策略｡

因此, 这些凭据现在将能够访问您的AWS（例如,

您的S3存储桶或DynamoDB表）, 而无需通过API网关或应用程序负载平衡器｡

这为您提供了一个可以在DynamoDB中执行行级安全性的用例｡

例如, 您可以使用来自Cognito身份池的策略｡

这个想法是, 在它里面, 你有一个条件,

这个条件是说DynamoDB的前导键必须等于Cognito身份用户ID｡

因此, 使用此策略的用户将无法读取和写入DynamoDB表中的所有项,

这将是非常强大的功能,

但相反, 他们只能处理通过此条件有权访问的项｡

所以我知道Cognito是一个非常复杂的服务｡ 

谢天谢地, 你只需要在一个高层次上知道它的意思｡

因此, 这意味着您可以为Web和移动应用程序创建用户群｡

这意味着您可以在DynamoDB中启用行级安全性,

例如, 以获得细粒度访问｡

最后, 请记住Cognito用户池与API网关或应用程序负载平衡器之间的集成｡

好吧, 就这样｡ 

希望你喜欢｡ 

我们下节课再见｡

```markdown
**学习目标**

- 理解 Kinesis Data Streams 的核心概念：分片（shard）、分区键（partition key）、生产者与消费者模型以及容量模式（按需 vs 预配置）。
- 掌握吞吐计算、保留期与消费者模型（共享 vs 增强扇出）的要点。

**重点速览**

- 分片决定吞吐：每个分片默认支持约 1 MB/s 写入与 2 MB/s 读取（或 1,000 rec/s 写入）；分片数量决定流的容量。
- 生产者通过分区键决定记录落入哪个分片；消费者可为每个分片读取并处理数据，支持重放（保留期 1–365 天）。

**详细内容**

- 架构细节：
  - 生产者（SDK/KPL/Agent）发送记录到流，记录包含分区键与数据 blob（最大 1 MB）。分区键经哈希后映射到分片，确保同一键的记录在同一分片内排序。
  - 消费者可使用 KCL、Lambda、Data Firehose、Data Analytics 等读取数据；增强型扇出（enhanced fan-out）为每个消费者提供独立吞吐上限以避免竞争。
  - 容量模式：预配置（需要手动调整分片）与按需（自动扩缩），按需适合无法预测的峰值流量。
  - 安全：传输使用 HTTPS，静态加密可用 KMS，访问受 IAM 控制；可使用 VPC 终端节点与 CloudTrail 监控 API 调用。

**自测问题**

1. 分片（shard）如何影响 Kinesis 流的吞吐能力？
2. 何时选择按需模式而不是预配置分片？

```
